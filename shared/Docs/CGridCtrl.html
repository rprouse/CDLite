<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0048)http://www.codeproject.com/miscctrl/gridctrl.asp -->
<HTML><HEAD><TITLE>The Code Project - MFC Grid control 2.22 - Miscellaneous Controls</TITLE>
<META content="text/html; charset=iso-8859-1" http-equiv=Content-Type>
<META content=mailto:webmaster@codeproject.com http-equiv=Reply-to>
<META content="Free source code and tutorials for Windows developers." 
name=Description>
<META 
content="Free source code, Miscellaneous Controls, Visual C++, MFC, Windows, Grid Control, MFC" 
name=keywords>
<META 
content="Article content copyright Chris Maunder, 1999, everthing else © The Code Project 1999-2001, All Rights Reserved." 
name=Copyright><LINK href="CGridCtrl_files/global.css" rel=stylesheet 
type=text/css>
<META content="MSHTML 5.00.3314.2100" name=GENERATOR></HEAD>
<BODY aLink=red bgColor=white link=blue text=black vLink=purple>
<TABLE bgColor=#ff9900 border=0 cellPadding=0 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD width="100%">
      <TABLE bgColor=#ff9900 border=0 cellPadding=0 cellSpacing=1 
        width="100%"><TBODY>
        <TR>
          <TD vAlign=top><A href="http://www.codeproject.com/"><IMG 
            alt="The Code Project" border=0 height=60 
            src="CGridCtrl_files/cplogo.gif" width=120></A></TD>
          <TD align=right><SPAN id=AdBanner6><A 
            href="http://www.codeproject.com/script/admentor/ads.asp"><IMG 
            alt="View all our sponsors" border=1 height=60 
            src="CGridCtrl_files/sponsors.gif" width=20></A><A 
            href="http://www.codeproject.com/script/admentor/admentorredir.asp?id=94&amp;way=ban" 
            target=_blank><IMG 
            alt="Click here for Dundas Software - 3D accelerated presentation quality ASP charting " 
            border=1 height=60 src="CGridCtrl_files/chartbanner.gif" 
            width=468></A><A 
            href="http://www.codeproject.com/info/advertise.asp"><IMG 
            alt="Advertise on the CodeProject" border=1 height=60 
            src="CGridCtrl_files/advertise.gif" width=20></A></SPAN></TD></TR>
        <TR>
          <TD bgColor=#fbedbb colSpan=2>
            <TABLE bgColor=#fbedbb border=0 cellPadding=3 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD width="100%"><FONT size=1 style="FONT-SIZE: 8pt"><A 
                  href="http://www.codeproject.com/">Home</A> &gt;&gt; <A 
                  href="http://www.codeproject.com/miscctrl/">Miscellaneous 
                  Controls</A> &gt;&gt; <A 
                  href="http://www.codeproject.com/miscctrl/index.asp#Grid Control">Grid 
                  Control</A> </FONT><BR><BR><B><FONT size=4 
                  style="FONT-SIZE: 16pt">MFC Grid control 
                  2.22</FONT></B><BR><B>By <A 
                  href="mailto:cmaunder@mail.com">Chris Maunder</A> 
                  </B><BR><BR><FONT style="FONT-SIZE: 9pt">A fully featured MFC 
                  grid control for displaying tabular data. The grid is a custom 
                  control derived from CWnd&nbsp;</FONT> </TD>
                <TD align=right vAlign=top>
                  <TABLE border=0 cellPadding=1 cellSpacing=0>
                    <TBODY>
                    <TR vAlign=top>
                      <TD>&nbsp;</TD>
                      <TD><FONT class=SmallText size=1>VC++ 5.0-7.0, NT 4.0, 
                        Win95/98, W2K, WinCE 2.0-2.11</FONT></TD></TR>
                    <TR>
                      <TD>&nbsp;</TD>
                      <TD noWrap><FONT class=SmallText size=1>Posted 17 Nov 
                        1999</FONT></TD></TR>
                    <TR>
                      <TD>&nbsp;</TD>
                      <TD><FONT class=SmallText size=1>Updated 1 Jan 
                        2001</FONT></TD></TR>
                    <TR vAlign=top>
                      <TD><IMG height=15 src="CGridCtrl_files/save.gif" 
                        width=16></TD>
                      <TD><FONT class=SmallText size=1><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;n=MFC+Grid+control+2%2E22&amp;u=%2Fmiscctrl%2Fgridctrl%2Easp&amp;ct=%2Fmiscctrl%2Fgridctrl%2Easp"><B>Bookmark 
                        this</B></A></FONT></TD></TR>
                    <TR vAlign=top>
                      <TD><IMG height=16 src="CGridCtrl_files/bookmarks.gif" 
                        width=16></TD>
                      <TD><FONT class=SmallText size=1><A 
                        href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
                        bookmarks</A></FONT></TD></TR>
                    <TR vAlign=top>
                      <TD><IMG height=16 src="CGridCtrl_files/hlp.gif" 
                        width=16></TD>
                      <TD noWrap><FONT class=SmallText size=1><A 
                        href="http://www.codeproject.com/script/Articles/list_articles.asp?Author=Chris+Maunder">Articles 
                        by this author</A></FONT></TD></TR>
                    <TR vAlign=top>
                      <TD><IMG height=16 src="CGridCtrl_files/mail.gif" 
                        width=16></TD>
                      <TD><FONT class=SmallText size=1><A 
                        href="http://www.codeproject.com/script/recommend/form.asp?pg=http%3A%2F%2Fwww%2Ecodeproject%2Ecom%2Fmiscctrl%2Fgridctrl%2Easp&amp;tt=MFC+Grid+control+2%2E22">Send 
                        to a friend</A></FONT></TD></TR>
                    <TR vAlign=top>
                      <TD><IMG height=16 src="CGridCtrl_files/print.gif" 
                        width=16></TD>
                      <TD noWrap><FONT class=SmallText size=1><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?print=true" 
                        target=_print>Printer friendly 
                    version</A></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <SCRIPT>
function Popup(elm) 
{
	elm.style.backgroundColor = "#ffcc99";
	elm.style.borderTopColor = "white";
	elm.style.borderLeftColor = "white";
	elm.style.borderBottomColor = "#FBEDBB";
	elm.style.borderRightColor = "#FBEDBB";
	elm.style.borderStyle = "outset";
	elm.style.padding = "1px 3px";
	//window.status = elm.href;
	return true;
}
function Popdown(elm) 
{
	elm.style.backgroundColor = "#FBEDBB";
	elm.style.borderStyle = "none";
	elm.style.padding = "2px 4px";
	return true;
}
function Popin(elm) 
{
	elm.style.backgroundColor = "#ffcc99";
	elm.style.borderTopColor = "#FBEDBB";
	elm.style.borderLeftColor = "#FBEDBB";
	elm.style.borderBottomColor = "white";
	elm.style.borderRightColor = "white";
	elm.style.borderStyle = "inset";
	elm.style.padding = "1px 3px";
	return true;
}
</SCRIPT>

            <SCRIPT event=onmouseover for=HoverNL language=JavaScript>
	return Popup( this);
</SCRIPT>

            <SCRIPT event=onfocus for=HoverNL language=JavaScript>
	return Popup( this);
</SCRIPT>

            <SCRIPT event=onmouseout for=HoverNL language=JavaScript>
	return Popdown( this);
</SCRIPT>

            <SCRIPT event=onblur for=HoverNL language=JavaScript>
	return Popdown( this);
</SCRIPT>

            <SCRIPT event=onmousedown for=HoverNL language=JavaScript>
	return Popin( this);
</SCRIPT>

            <SCRIPT event=onclick for=HoverNL language=JavaScript>
	return Popin( this);
</SCRIPT>

            <TABLE bgColor=#fbedbb border=0 cellPadding=2 cellSpacing=0 
            width="100%">
              <TBODY>
              <TR>
                <FORM action=/info/search.asp method=post name=Search 
                target=_top>
                <TD align=middle vAlign=bottom>
                  <TABLE border=0 cellPadding=1 cellSpacing=0>
                    <TBODY>
                    <TR>
                      <TD vAlign=center><INPUT class=smalltext maxLength=255 
                        name=target size=12></TD>
                      <TD align=left vAlign=center width="100%"><INPUT class=formButton type=submit value=Search></TD></TR></TBODY></TABLE></TD></FORM>
                <TD align=middle noWrap vAlign=center><A class=HoverLink 
                  href="http://www.codeproject.com/lounge.asp" name=HoverNL 
                  title="Visit the Lounge"><IMG align=top border=0 height=16 
                  src="CGridCtrl_files/lounge_small.gif"> Lounge</A> </TD>
                <TD align=middle noWrap vAlign=center><A class=HoverLink 
                  href="http://www.codeproject.com/info/latest.asp" name=HoverNL 
                  title="View the latest additions and updates at CodeProject"><IMG 
                  align=top border=0 height=16 
                  src="CGridCtrl_files/latest_small.gif"> New Articles</A> </TD>
                <TD align=middle noWrap vAlign=center><A class=HoverLink 
                  href="http://www.codeproject.com/script/profile/modify.asp?ct=%2Fmiscctrl%2Fgridctrl%2Easp" 
                  name=HoverNL 
                  title="Modify your profile and Newsletter subscription"><IMG 
                  align=top border=0 height=16 
                  src="CGridCtrl_files/profile_small.gif"> My Settings</A> </TD>
                <TD align=middle noWrap vAlign=center><A class=HoverLink 
                  href="http://www.codeproject.com/script/profile/logoff.asp?ct=%2Fmiscctrl%2Fgridctrl%2Easp" 
                  name=HoverNL title="Logoff your Code Project account"><IMG 
                  align=top border=0 height=16 
                  src="CGridCtrl_files/logoff_small.gif"> Sign out</A> </TD>
                <TD align=middle noWrap vAlign=center><A class=HoverLink 
                  href="http://www.codeproject.com/script/comments/forums.asp" 
                  name=HoverNL 
                  title="Need an answer to a programming problem?"><IMG 
                  align=top border=0 height=16 
                  src="CGridCtrl_files/forums_small.gif"> <B>Forums</B></A> </TD>
                <TD align=middle noWrap vAlign=center><A class=HoverLink 
                  href="http://www.codeproject.com/info/submit.html" 
                  name=HoverNL 
                  title="Got a cool article you want to share?"><IMG align=top 
                  border=0 height=16 src="CGridCtrl_files/submit_small.gif"> 
                  Contribute</A> 
  </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE width="100%">
  <TBODY>
  <TR>
    <TD noWrap><SPAN class=smallText>Broken links? <A 
      href="http://www.codeproject.com/script/common/mailform.asp?option=Article&amp;Title=MFC+Grid+control+2%2E22&amp;URL=http%3A%2F%2Fwww%2Ecodeproject%2Ecom%2Fmiscctrl%2Fgridctrl%2Easp">Email 
      us!</A></SPAN></TD>
    <TD align=right width="100%"><A name=__top></A>
      <TABLE>
        <TBODY>
        <TR>
          <TD align=right><FONT style="FONT-SIZE: 80%">282 users have rated 
            this article. result:</FONT></TD>
          <TD>
            <TABLE border=2 cellPadding=0 cellSpacing=0>
              <TBODY>
              <TR>
                <TD><IMG border=0 height=5 src="CGridCtrl_files/red.gif" 
                  width=20></TD>
                <TD><IMG border=0 height=5 src="CGridCtrl_files/red.gif" 
                  width=20></TD>
                <TD><IMG border=0 height=5 src="CGridCtrl_files/red.gif" 
                  width=20></TD>
                <TD><IMG border=0 height=5 src="CGridCtrl_files/red.gif" 
                  width=20></TD>
                <TD><IMG border=0 height=5 src="CGridCtrl_files/red.gif" 
                  width=16><IMG border=0 height=5 
                  src="CGridCtrl_files/white.gif" 
width=4></TD></TR></TBODY></TABLE></TD>
          <TD><FONT style="FONT-SIZE: 80%"><B>4.82</B> out of 
        5.</FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><!-- Article Starts -->
<LI class=download><A 
href="http://www.codeproject.com/miscctrl/gridctrl/gridctrl_demo222.zip">Download 
demo project (v2.22) - 261 Kb</A> 
<LI class=download><A 
href="http://www.codeproject.com/miscctrl/gridctrl/gridctrl_src.zip">Download 
source (v2.22) - 100 Kb</A> 
<P><IMG align=bottom alt="gridctrl example image" border=0 height=228 
src="CGridCtrl_files/gridctrl.gif" width=341> 
<H2>Preface</H2>
<P>The grid in its current form will no longer be extended with new features. 
There are still a couple of bugs in the code that I will fix ASAP, and I 
<I>may</I> add one or two minor features that I have the code for, but not the 
time at present to integrate. My plan is to port the grid over to C# and 
continue from there. I understand that a lot of people are using and extending 
the grid, and I would like to thank the hundreds who have sent in their 
modifications, bug fixes, extensions, tweaks and sample apps. Unfortunately 
there are simply not enough hours in the day to continue to support two grids. I 
will still try and roll out bug fixed versions where appropriate. 
<P>The latest version (2.22) has made changes in editing validation, scrolling, 
sorting and selection, and the grid cells have added functionality. Also, 
messages sent by the grid have been improved and can be used to control the 
behaviour of cell editing. 
<P>Check out latest changes (version 2.22) <A 
href="http://www.codeproject.com/miscctrl/gridctrl.asp#New">here</A>.</P>
<P><B>Note</B>: Version 2.12 of the grid is still available for download <A 
href="http://www.codeproject.com/miscctrl/gridctrl/gridctrl_demo212.zip">here 
(101 Kb)</A> <!-- TOC -->
<P>
<TABLE cellSpacing=5 width="90%">
  <TBODY>
  <TR>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Introduction">Introduction</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Appearance">General 
      appearance and features</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Structures">Structures, 
      defines and Messages</A></TD></TR>
  <TR>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Structure">Structure</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Files">Files</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Colours">Colours</A></TD></TR>
  <TR>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Overrides">Protected 
      overridable functions</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Constuction">Construction</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#CellInfo">General 
      cell information</A></TD></TR>
  <TR>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Clipboard">Clipboard</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#NumRowsCols">Number 
      of rows and columns</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Operations">Operations</A></TD></TR>
  <TR>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Sorting">Sorting</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Sizing">Sizing and 
      position functions</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Printing">Printing</A></TD></TR>
  <TR>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Virtual">Virtual 
      Mode</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#EditValidate">Cell 
      Editing and Validation</A></TD>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#History">History</A></TD></TR>
  <TR>
    <TD><A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#Acknowledgements">Acknowledgements</A></TD>
    <TD><A 
    href="http://www.codeproject.com/miscctrl/gridctrl.asp#Sorting"></A></TD>
    <TD><A 
    href="http://www.codeproject.com/miscctrl/gridctrl.asp#Sorting"></A></TD></TR></TBODY></TABLE><BR><BR><!-- the article... -->
<H2><A name=Introduction>Introduction</A></H2>
<P>After pushing the <CODE>CListCtrl</CODE> to its limits in trying to display 
and edit tabulated data I decided what was really needed was a dedicated grid 
control. I started writing my own grid control from scratch but decided to save 
time by modifying <A href="mailto:chinajoe@aol.com">Joe Willcoxson's</A> free 
WorldCom grid control at <A 
href="http://users.aol.com/chinajoe/wcmfclib.html">http://users.aol.com/chinajoe/wcmfclib.html</A>. 
I tore apert his code and rebuilt it from the ground up in order to get it to do 
all the things I needed. The code has gone through so many modifications that 
I'm not sure if there is even a single original line of code. In any case Joe's 
code was a great framework on which to build. 
<P>The project started out as a simple clean up but very quickly ballooned into 
a bit of a nightmare as I kept finding new features that I felt just <I>had</I> 
to go into it. It has not been tested exhaustively - but I'm fairly confident 
that it won't fall over too badly :). Joe was kind enough to allow me to release 
the source with no strings attached (since it is based on his code) but since 
the project was such a marathon I am placing a couple of very minor conditions 
on the use of this code: 
<BLOCKQUOTE style="BACKGROUND-COLOR: #fbedbb"><I>
  <P>This code may be used in compiled form in any way you desire (including 
  commercial use). The code may be redistributed unmodified by any means 
  <B>providing</B> it is not sold for profit without the authors written 
  consent, and providing that this notice and the authors name and all copyright 
  notices remains intact. However, this file and the accompanying source code 
  <B>may not</B> be hosted on a website or bulletin board without the authors 
  written permission.</P>
  <P><B>This software is provided "as is" without express or implied warranty. 
  Use it at your own risk!</B></P>
  <P>Whilst I have made every effort to remove any undesirable "features", I 
  cannot be held responsible if it causes any damage or loss of time or 
  data.</P></I></BLOCKQUOTE>Hopefully that isn't too much to ask considering the 
amount of work that went into this. If you <I>do</I> use it in a commercial 
application then <B>please</B> send me an <A 
href="mailto:cmaunder@mail.com">email</A> letting me know. There's no point in 
me releasing and maintaining/upgrading this thing if no one is gonna use it. 
<P>The control features: 
<UL>
  <LI>Cell selection using the mouse, with optional Control and Shift key 
  combinations. Selection can be disabled. 
  <LI>Row and Column resizing. Sizing can be diabled for row, columns or both. 
  <LI>Auto row or column sizing when dividers are double-clicked. 
  <LI>Any number of fixed rows and columns. 
  <LI>Individual cells can have separate text and background colours. 
  <LI>Individual cells can have separate fonts. 
  <LI>Individaul cells can be marked "Read-Only", or have their modification 
  status set and checked. 
  <LI>OLE Drag and drop. 
  <LI>Ctrl-C, Ctrl-X and Ctrl-V perform clipboard copy, cut and paste, and 
  Ctrl-A for "Select All" 
  <LI>In place editing of cell contents. If a character key is pressed while a 
  cell has focus, editing will start on that cell, and the arrow keys will allow 
  navigation to other keys. If the current focus cell is clicked on, editing 
  will start and the arrow keys will move the carot inside the edit control. 
  Editing can be disabled. 
  <LI>Support for Microsoft intellimouse. 
  <LI>Optional grid lines. 
  <LI>Images in any cell 
  <LI>"Virtual" mode for large datasets 
  <LI>Full printing support, for either a Doc/View environment (inc Print 
  preview) or a standalone dialog based app (no print preview). 
  <LI>Optional "List mode", including full row selection, single row selection, 
  and sort on column header click. 
  <LI>Numerous virtual functions to allow this control to be extended very 
  easily. 
  <LI>Unicode support. 
  <LI>WinCE support 
  <LI>Titletips for cells that are too small to display their data. 
  <LI>Hidden rows and columns 
  <LI>Compiles under VC 4.2, 5.0, 6.0 and under the CE toolkit version 2.0 and 
  3.0 </LI></UL>The <A 
href="http://www.codeproject.com/miscctrl/gridctrl/gridctrl_demo220.zip">sample 
project</A> demonstrates most of the features of the grid control. 
<H2><A name=Files>Files</A></H2>
<P>To use the Grid control in your project you will need to add a number of 
files to your project: <BR><BR>
<TABLE cellSpacing=0 width="100%">
  <TBODY>
  <TR vAlign=top>
    <TD width="5%">&nbsp;</TD>
    <TD><CODE>gridctrl.cpp, gridctrl.h</CODE></TD>
    <TD>Main grid control source and header files.</TD></TR>
  <TR>
    <TD width="5%"></TD>
    <TD><CODE>gridcellbase.cpp, gridcellbase.h</CODE></TD>
    <TD>Main grid cell base class.</TD></TR>
  <TR>
    <TD width="5%"></TD>
    <TD><CODE>gridcell.cpp, gridcell.h</CODE></TD>
    <TD>Main grid cell default class implementation.</TD></TR>
  <TR vAlign=top>
    <TD width="5%">&nbsp;</TD>
    <TD><CODE>CellRange.h</CODE></TD>
    <TD>Definition of CCellID and CCellRange helper classes.</TD></TR>
  <TR vAlign=top>
    <TD width="5%">&nbsp;</TD>
    <TD><CODE>MemDC.h</CODE></TD>
    <TD><A href="http://www.codeproject.com/miscctrl/keithr@europa.com">Keith 
      Rule</A>'s memory DC helper class.</TD></TR>
  <TR vAlign=top>
    <TD width="5%">&nbsp;</TD>
    <TD noWrap><CODE>InPlaceEdit.cpp, InPlaceEdit.h</CODE></TD>
    <TD>In-place edit windows source and header files.</TD></TR>
  <TR vAlign=top>
    <TD width="5%">&nbsp;</TD>
    <TD noWrap><CODE>GridDropTarget.cpp, GridDropTarget.h</CODE></TD>
    <TD>Grid control OLE drag and drop target. Only necessary if you don't 
      define GRIDCONTROL_NO_DRAGDROP in gridctrl.h</TD></TR>
  <TR vAlign=top>
    <TD width="5%">&nbsp;</TD>
    <TD width="45%"><CODE>Titletip.cpp, Titletip.h</CODE></TD>
    <TD width="50%">Titletips for cells, from <A 
      href="http://www.codeguru.com/">http://www.codeguru.com/</A> Only 
      necessary if you don't define GRIDCONTROL_NO_TITLETIPS in 
  gridctrl.h</TD></TR></TBODY></TABLE><A name=Structure></A>
<H2>Structure</H2>
<P>The grid is based on a framework (the <CODE>CGridCtrl</CODE> object) that 
organises and controls a collection of cells (<CODE>CGridBaseCell</CODE>) that 
contain the data, perform operations such as drawing, and handle methods such as 
button clicks. The grid object itself handles events such as button clicks 
before the cells get a chance, and will pass on certain mouse messages if it 
considers it necessary. The grid also contains a drag and drop target 
(<CODE>CGridDropTarget</CODE>) that is registered to handle drop notifications, 
and there is also a title tip object (<CODE>CTitleTip</CODE>) that displays the 
contents of cells when the physical dimensions of a cell are insufficient to 
display its' contents in their entirety. 
<P>The grid cells can be of any type as long as the class is derived from 
<CODE>CGridBaseCell</CODE>. Included with the package is a 
<CODE>CGridCell</CODE> class that handles basic data storage and editing. 
Extensions such as the <CODE>CGridCellCombo</CODE> and <CODE>CGridURLCell</CODE> 
class demonstrate how to create your own cell classes. 
<P>There are two main types of cell - fixed and non-fixed. Fixed cells are 
typically on the left and top of the grid and do not move when the grid is 
scrolled. Typically these contain column and row headings and are not editable. 
Non fixed cells make up the "interior" of the grid and can be edited and 
selected. 
<P>Default values for various properties of the grid are stored in 
<CODE>CGridDefaultCell</CODE> objects. There are currently 4 of these objects 
per grid - one each to hold default values for the non-fixed cells, fixed 
columns, foxed rows, and cells that are both fixed rows and columns cells. Thus 
in order to set a default property for the grid, use 
<CODE>CGridCtrL::GetDefaultCell</CODE> to get the default cell implementation 
you are after, then set it's values directly. 
<P>Cells hold their property values explicitely, except for the font property. 
Each cell holds a pointer to a font structure, and this pointer is only 
allocated and used if you set that cell's font to a non-default value. 
<P>The grid also has a <B>virtual mode</B> that stops the grid from actually 
creating cells, and allows you to specify either a callback funtion or message 
handler that the grid will call each time it needs information on a cell. This 
saves enourmously on memory at the expense of slightly decreased performance. 
There is a <CODE>GVN_ODCACHEHINT</CODE> message that is sent to the grid's 
parent that will help you cache data in preparation for the grid's cell info 
requests. 
<P>Grid cells are stored row-by-row, so all operations on large numbers of cells 
should be done row-by-row as well. 
<H2><A name=Constuction>Construction</A></H2>
<P>OK - so how do you use it? 
<P>The underlying class of the grid control is <CODE>CGridCtrl</CODE> which is 
derived from <CODE>CWnd</CODE>. To use it, either use the MS Visual C++ dialog 
editor to place a custom control on a dialog, and enter "MFCGridCtrl" (no 
quotes) as the Class name. To subclass the control using the <CODE>DDX</CODE> 
mechanism (this will be done by default by the ClassWizard) use the 
<CODE>DDX_GridControl</CODE> function instead of the <CODE>DDX_Control</CODE> 
function (just manually change the ClassWizard entry). This ensures your control 
is correctly registered as a drop target and avoids some weird win95 issues. 
<P>Alternatively you can use <CODE>CGridCtrl::Create</CODE>: </P><PRE>CGridCtrl grid;
grid.Create(rect, pParentWnd, nID);
</PRE>
<P></P>where <I>rect</I> is the dimensions, <B>pParentWnd</B> is the parent 
window, and <I>nID</I> is the id. 
<H2><A name=NumRowsCols>Number of rows and columns</A></H2>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetRowCount() const</CODE> </TD>
    <TD width="50%">Returns the number of rows (including fixed rows)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetColumnCount() const</CODE> </TD>
    <TD width="50%">Returns the number of columns (including fixed 
  columns)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetFixedRowCount() const</CODE> </TD>
    <TD vAlign=top width="50%">Returns the number of fixed rows</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetFixedColumnCount() const</CODE> </TD>
    <TD width="50%">Returns the number of fixed columns</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetRowCount(int nRows)</CODE> </TD>
    <TD width="50%">Sets the number of rows (including fixed rows), Returning 
      TRUE on success.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetColumnCount(int nCols)</CODE> </TD>
    <TD width="50%">Sets the number of columns (including fixed columns), 
      Returning TRUE on success.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetFixedRowCount(int nFixedRows = 1)</CODE> </TD>
    <TD width="50%">Sets the number of fixed rows, returning TRUE on 
    success.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetFixedColumnCount(int nFixedCols = 1)</CODE> 
    </TD>
    <TD width="50%">Sets the number of columns, returning TRUE on 
  success.</TD></TR></TBODY></TABLE>
<H2><A name=Sizing>Sizing and position functions</A></H2>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetRowHeight(int nRow) const</CODE> </TD>
    <TD width="50%">Gets the height of row nRow.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetRowHeight(int row, int height)</CODE> </TD>
    <TD width="50%">Sets the height of row nRow.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetColumnWidth(int nCol) const</CODE> </TD>
    <TD width="50%">Gets the width of column nCol</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetColumnWidth(int col, int width)</CODE> </TD>
    <TD width="50%">Sets the width of column nCol.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetFixedRowHeight() const</CODE> </TD>
    <TD width="50%">Gets the combined height of the fixed rows.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetFixedColumnWidth() const</CODE> </TD>
    <TD width="50%">Gets the combined width of the fixed columns.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>long GetVirtualHeight() const</CODE> </TD>
    <TD width="50%">Gets the combined height of all the rows.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>long GetVirtualWidth() const</CODE> </TD>
    <TD width="50%">Gets the combined width of all the columns.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetCellOrigin(int nRow, int nCol, LPPOINT 
      p)</CODE> </TD>
    <TD width="50%">Gets the topleft point for cell (nRow,nCol), returning 
      TRUE if successful. (cell must be visible for success).</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetCellOrigin(const CCellID&amp; cell, LPPOINT 
      p)</CODE> </TD>
    <TD width="50%">Gets the topleft point for the given cell, returning TRUE 
      if successful. (cell must be visible for success). See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#CCellID">CCellID<A>.</A></TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetCellRect(int nRow, int nCol, LPRECT 
      pRect)</CODE> </TD>
    <TD width="50%">Gets the bounding rectangle for the given cell, returning 
      TRUE if successful. (cell must be visible for success).</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetCellRect(const CCellID&amp; cell, LPRECT 
      pRect)</CODE> </TD>
    <TD width="50%">Gets the bounding rectangle for the given cell, returning 
      TRUE if successful. (cell must be visible for success). See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#CCellID">CCellID<A>.</A></TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetTextRect(int nRow, int nCol, LPRECT 
      pRect)t</CODE> </TD>
    <TD width="50%">Gets the bounding rectangle for the text in the given 
      cell, returning TRUE if successful. (cell must be visible for 
  success).</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetTextRect(const CCellID&amp; cell, LPRECT 
      pRect)</CODE> </TD>
    <TD width="50%">Gets the bounding rectangle for the text in the given 
      cell, returning TRUE if successful. (cell must be visible for success). 
      See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#CCellID">CCellID<A>.</A></TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetTextExtent(int nRow, int nCol, LPCTSTR 
      str)</CODE> </TD>
    <TD width="50%">Gets the bounding rectangle for the given text for the 
      given cell, returning TRUE if successful.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetCellTextExtent(int nRow, int nCol)</CODE> 
</TD>
    <TD width="50%">Gets the bounding rectangle for the text in the given 
      cell, returning TRUE if successful.</TD></TR></TBODY></TABLE>
<H2><A name=Virtual>Virtual Mode</H2>
<P>Virtual mode allows you to use the grid to display large amounts of data 
without requiring the grid to actually store this data. In Virtual Mode, no 
cells are created and no data is stored other than the widths and heights of 
columns and rows. 
<P>Since the data is not stored by the grid, the grid must have some way of 
asking the application to supply it with data. This is done either by either 
registering a callback function with the grid, or by having the parent handle a 
<CODE>GVN_GETDISPINFO</CODE> notification.</P>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetVirtualMode(BOOL bVirtual)</CODE></TD>
    <TD width="50%">Places the grid in or out of virtual mode.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetVirtualMode()</CODE></TD>
    <TD width="50%">Returns TRUE if the grid is in virtual mode.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetCallbackFunc(GRIDCALLBACK pCallback, LPARAM 
      lParam) </CODE></TD>
    <TD width="50%">Sets the callback function for when the grid is in virtual 
      mode.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>GRIDCALLBACK GetCallbackFunc() </CODE></TD>
    <TD width="50%">Returns the callback function when the grid is in virtual 
      mode.</TD></TR></TBODY></TABLE>
<P>If no callback function is specified then the grid will send a 
<CODE>GVN_GETDISPINFO</CODE> message to it's parent. A <CODE>GV_DISPINFO</CODE> 
structure part of this notification, and looks like:</P><PRE>typedef struct tagGV_DISPINFO {
    NMHDR   hdr;
    GV_ITEM item;
} GV_DISPINFO;
</PRE>
<P>Obviously it's nice to have a hint as to what sort of data the grid will be 
asking for in order to allow caching, so the grid sends out a 
<CODE>GVN_ODCACHEHINT</CODE> message before displaying a page of cells. A 
<CODE>GV_CACHEHINT</CODE> structure is sent as part of this message and looks 
like:</P><PRE>typedef struct tagGV_CACHEHINT {
    NMHDR      hdr;
    CCellRange range;
} GV_CACHEHINT;
</PRE>
<P>An example of handling these messages is as follows: </P><PRE>// m_Grid is a member variable of a dialog class that is handling this message
BOOL CGridCtrlDemoDlg::OnNotify(WPARAM wParam, LPARAM lParam, LRESULT* pResult) 
{
    if (wParam == (WPARAM)m_Grid.GetDlgCtrlID())
    {
        *pResult = 1;
        GV_DISPINFO *pDispInfo = (GV_DISPINFO*)lParam;
        if (GVN_GETDISPINFO == pDispInfo-&gt;hdr.code)
        {
            //TRACE2("Getting Display info for cell %d,%d\n", pDispInfo-&gt;item.row, pDispInfo-&gt;item.col);
            pDispInfo-&gt;item.strText.Format(_T("Message %d,%d"),pDispInfo-&gt;item.row, pDispInfo-&gt;item.col);
            return TRUE;
        }
        else if (GVN_ODCACHEHINT == pDispInfo-&gt;hdr.code)
        {
            GV_CACHEHINT *pCacheHint = (GV_CACHEHINT*)pDispInfo;
            TRACE(_T("Cache hint received for cell range %d,%d - %d,%d\n"),
                  pCacheHint-&gt;range.GetMinRow(), pCacheHint-&gt;range.GetMinCol(),
                  pCacheHint-&gt;range.GetMaxRow(), pCacheHint-&gt;range.GetMaxCol());
        }
    }
    
	return CDialog::OnNotify(wParam, lParam, pResult);
}
</PRE>
<P>You can use <CODE>SetCallbackFunc</CODE> to set a callback function that the 
grid will call directly instead of sending a <CODE>GVN_GETDISPINFO</CODE> 
message. A <CODE>GVN_ODCACHEHINT</CODE> message will still be send if a callback 
is used. 
<P>The callback function should be of the form: </P><PRE>BOOL CALLBACK CallbackFunction(GV_DISPINFO * pDispInfo, LPARAM lParam);</PRE>
<P>For example: </P><PRE>BOOL CALLBACK CGridCtrlDemoDlg::GridCallback(GV_DISPINFO *pDispInfo, LPARAM /*lParam*/) 
{
    pDispInfo-&gt;item.strText.Format(_T("Callback %d,%d"),pDispInfo-&gt;item.row, pDispInfo-&gt;item.col);
    return TRUE;
}</PRE>
<P>When calling <CODE>SetCallbackFunc</CODE> you can specify an 
<CODE>LPARAM</CODE> value that will be passed to the callback function each time 
it is called. Note that the callback function must be a static or global 
function. 
<H2><A name=Appearance>General appearance and features</A></H2>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetImageList(CImageList* pList)</CODE> </TD>
    <TD width="50%">Sets the current image list for the grid. The control only 
      takes a copy of the pointer to the image list, not a copy of the list 
      itself.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>CImageList* GetImageList()</CODE> </TD>
    <TD width="50%">Gets the current image list for the grid.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetGridLines(int nWhichLines = GVL_BOTH)</CODE> 
    </TD>
    <TD width="50%">Sets which (if any) gridlines are displayed. See <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GVL_Values">here</A> 
      for possible values.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetGridLines() </CODE></TD>
    <TD width="50%">Gets which (if any) gridlines are displayed. See <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GVL_Values">here</A> 
      for possible return values.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetEditable(BOOL bEditable = TRUE)</CODE> </TD>
    <TD width="50%">Sets if the geid is editable.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsEditable()</CODE> </TD>
    <TD width="50%">Gets whether or not the grid is editable.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetListMode(BOOL bEnableListMode = TRUE)</CODE> 
    </TD>
    <TD width="50%">Sets the grid into (or out of) List mode. When the grid is 
      in list mode, full row selection is enabled and clicking on the column 
      header will sort the grid by rows.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetListMode()</CODE> </TD>
    <TD width="50%">Get whether or not the grid is in list mode.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetSingleRowSelection(BOOL bSing = TRUE)</CODE> 
    </TD>
    <TD width="50%">Sets the grid into (or out of) Single row selection mode. 
      This mode is only effective when in ListMode. When in this mode, only a 
      single row at a time can be selected, so the grid behaves somewhat like a 
      multicolumn listbox.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetSingleRowSelection()</CODE> </TD>
    <TD width="50%">Get whether or not the grid is in single row selection 
      mode.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetSingleColSelection(BOOL bSing = TRUE)</CODE> 
    </TD>
    <TD width="50%">Sets the grid into (or out of) Single column selection 
      mode. When in this mode, only a single column at a time can be 
  selected.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetSingleColSelection()</CODE> </TD>
    <TD width="50%">Get whether or not the grid is in single column selection 
      mode.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnableSelection(BOOL bEnable = TRUE)</CODE> </TD>
    <TD width="50%">Sets whether or not the grid cells can be selected.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsSelectable()</CODE> </TD>
    <TD width="50%">Get whether or not grid cells are selectable.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetFixedRowSelection(BOOL bSelect)</CODE> </TD>
    <TD width="50%">Set whether or not clicking on a fixed row selects the 
      cells next to it.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetFixedRowSelection()</CODE> </TD>
    <TD width="50%">Get whether or not clicking on a fixed row selects the 
      cells next to it.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetFixedColumnSelection(BOOL bSelect)</CODE> 
</TD>
    <TD width="50%">Set whether or not clicking on a fixed column selects the 
      cells underneath.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetFixedColumnSelection()</CODE> </TD>
    <TD width="50%">Get whether or not clicking on a fixed column selects the 
      cells underneath.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnableDragAndDrop(BOOL bAllow = TRUE)</CODE> 
</TD>
    <TD width="50%">Sets whether drag and drop is enabled.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetDragAndDrop()</CODE> </TD>
    <TD width="50%">Get whether drag and drop is allowed.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetRowResize(BOOL bResize = TRUE) </CODE></TD>
    <TD width="50%">Sets whether or not rows can be resized.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetRowResize()</CODE> </TD>
    <TD width="50%">Gets whether or not rows can be resized.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetColumnResize(BOOL bResize = TRUE)</CODE> </TD>
    <TD width="50%">Sets whether or not columns can be resized.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetColumnResize()</CODE> </TD>
    <TD width="50%">Gets whether or not columns can be resized.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetHandleTabKey(BOOL bHandleTab = TRUE)</CODE> 
    </TD>
    <TD width="50%">Sets whether or not the TAB key is used to move the cell 
      selection.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetHandleTabKey()</CODE> </TD>
    <TD width="50%">Gets whether or not the TAB key is used to move the cell 
      selection.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetDoubleBuffering(BOOL bBuffer = TRUE)</CODE> 
    </TD>
    <TD width="50%">Sets whether or not double buffering is used when painting 
      (avoids flicker).</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetDoubleBuffering()</CODE> </TD>
    <TD width="50%">Gets whether or not double buffering is used when 
    painting.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnableTitleTips(BOOL bEnable = TRUE)</CODE> </TD>
    <TD width="50%">Sets whether or not titletips are used.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetTitleTips()</CODE></TD>
    <TD width="50%">Gets whether or not titletips are used.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetTrackFocusCell(BOOL bTrack)</CODE></TD>
    <TD width="50%">Sets whether or not the fixed cells on the same row/column 
      as the current focus cell are highlighted with a sunken border</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetTrackFocusCell()</CODE></TD>
    <TD width="50%">Gets whether or not the fixed cells on the same row/column 
      as the current focus cell are highlighted with a sunken border</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetFrameFocusCell(BOOL bFrame)</CODE></TD>
    <TD width="50%">Sets whether or not the cell with the focus is highlighted 
      with a framed border</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetFrameFocusCell()</CODE></TD>
    <TD width="50%">Gets whether or not the focus cell is highlighted with a 
      framed border</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetAutoSizeStyle(int nStyle = 
    GVS_BOTH)</CODE></TD>
    <TD width="50%">Sets how the auto-sizing should be performed. GVS_BOTH = 
      use fixed and non fixed cells; GVS_HEADER = use only the fixed cells; 
      GVS_DATA = use only non-fixed cells. </TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetAutoSizeStyle()</CODE></TD>
    <TD width="50%">Gets how the auto-sizing should be performed</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnableHiddenColUnhide(BOOL bEnable = 
      TRUE)</CODE></TD>
    <TD width="50%">Sets whether or not hidden (0-width) columns can be 
      unhidden by the user resizing the column.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetHiddenColUnhide()</CODE></TD>
    <TD width="50%">Gets whether or not hidden (0-width) columns can be 
      unhidden by the user resizing the column.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnableHiddenRowUnhide(BOOL bEnable = 
      TRUE)</CODE></TD>
    <TD width="50%">Sets whether or not hidden (0-height) rows can be unhidden 
      by the user resizing the row.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetHiddenRowUnhide()</CODE></TD>
    <TD width="50%">Gets whether or not hidden (0-height) rows can be unhidden 
      by the user resizing the row.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnableColumnHide(BOOL bEnable = TRUE)</CODE></TD>
    <TD width="50%">Sets whether or columns can be contracted to 0 width via 
      mouse.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetColumnHide()</CODE></TD>
    <TD width="50%">Gets whether or not columns can be contracted to 0 width 
      via mouse.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnableRowHide(BOOL bEnable = TRUE)</CODE></TD>
    <TD width="50%">Sets whether or not rows can be contracted to 0 height via 
      mouse.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetRowHide()</CODE></TD>
    <TD width="50%">ets whether or not rows can be contracted to 0 height via 
      mouse.</TD></TR></TBODY></TABLE>
<H2><A name=Colours>Colours</A></H2>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetGridBkColor(COLORREF clr)</CODE> </TD>
    <TD width="50%">Sets the background colour of the control (the area 
      outside fixed and non-fixed cells).</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetGridBkColor() </CODE></TD>
    <TD width="50%">Gets the background colour of the control.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetGridLineColor(COLORREF clr)</CODE></TD>
    <TD width="50%">Sets the colour of the gridlines.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetGridLineColor() </CODE></TD>
    <TD width="50%">Gets the colour of the grid lines.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetTitleTipBackClr() </CODE></TD>
    <TD width="50%">Gets the background colour of the titletips.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetTitleTipBackClr(COLORREF clr = 
      CLR_DEFAULT)</CODE></TD>
    <TD width="50%">Sets the background colour of the titletips.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetTitleTipTextClr() </CODE></TD>
    <TD width="50%">Gets the text colour of the titletips.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetTitleTipTextClr(COLORREF clr = 
      CLR_DEFAULT)</CODE></TD>
    <TD width="50%">Sets the text colour of the titletips.</TD></TR></TBODY></TABLE>
<P><B>The following functions are no longer supported.</B> You should use 
<CODE>GetDefaultCell</CODE> to get the default cell implementation for the cell 
type you are intererested in, then set that cell's properties directly. If a 
given cell has default values set, then it will use the values in the default 
cell implementation that matches that cell type.</P>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetTextColor(COLORREF clr)</CODE> </TD>
    <TD width="50%">Sets the colour of the text in non-fixed cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetTextColor()</CODE> </TD>
    <TD width="50%">Gets the colour of the text in non-fixed cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetTextBkColor(COLORREF clr)</CODE> </TD>
    <TD width="50%">Sets the background colour of the non-fixed cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetTextBkColor() </CODE></TD>
    <TD width="50%">Gets the background colour of the non-fixed cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetFixedTextColor(COLORREF clr)</CODE> </TD>
    <TD width="50%">Sets the colour of the text in fixed cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetFixedTextColor()</CODE> </TD>
    <TD width="50%">Gets the colour of the text in fixed cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetFixedBkColor(COLORREF clr)</CODE> </TD>
    <TD width="50%">Sets the background colour of the fixed cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetFixedBkColor() </CODE></TD>
    <TD width="50%">Gets the background colour of the fixed cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetBkColor(COLORREF clr)</CODE> </TD>
    <TD width="50%">Sets the background colour of the control (the area 
      outside fixed and non-fixed cells).</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetBkColor() </CODE></TD>
    <TD width="50%">Gets the background colour of the control.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetGridColor(COLORREF clr)</CODE></TD>
    <TD width="50%">Sets the colour of the gridlines.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetGridColor() </CODE></TD>
    <TD width="50%">Gets the colour of the grid lines.</TD></TR></TBODY></TABLE>
<P>See also the <A 
href="http://www.codeproject.com/miscctrl/gridctrl.asp#CellColours">Individual 
Cell colour functions</A> that allow an individual cell's colours to be changes 
seperate to the rest of the grid. 
<H2><A name=CellInfo>General cell information</A></H2>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>CGridCellBase* GetDefaultCell(BOOL bFixedRow, BOOL 
      bFixedCol) const</CODE></TD>
    <TD width="50%">Gets a pointer to the default cell implementation for the 
      desired cell type. <I>bFixedRow</I> and <I>bFixedCol</I> specify whether 
      the cell is fixed (in row, column or both) or unfixed. Use this to set 
      default properties for the grid. Actual cells in the grid have their 
      values set as default values when they are first created. They will use 
      <CODE>GetDefaultCell</CODE> to query the grids default cell properties and 
      use these values for drawing themselves.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>CGridCellBase* GetCell(int nRow, int nCol) 
      const</CODE></TD>
    <TD width="50%">Gets the actual cell for the given row/column (or NULL on 
      failure)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetCellType(int nRow, int nCol, CRuntimeClass* 
      pRuntimeClass);</CODE></TD>
    <TD width="50%">Sets the cell class type.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetDefaultCellType(CRuntimeClass* 
      pRuntimeClass);</CODE></TD>
    <TD width="50%">Sets the default cell class type for new cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetModified(BOOL bModified = TRUE, int nRow = 
      -1, int nCol = -1)</CODE> </TD>
    <TD width="50%">Sets the modified flag for a cell. If no row or columns is 
      specified, then change affects the entire grid.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetModified(int nRow = -1, int nCol = 
      -1)</CODE> </TD>
    <TD width="50%">Sets the modified flag for a cell, or if no cell, it 
      returns the status for the entire grid.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsCellFixed(int nRow, int nCol)</CODE> </TD>
    <TD width="50%">Returns TRUE if the cell is a fixed cell.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsItemEditing(int nRow, int nCol)</CODE> </TD>
    <TD width="50%">Returns TRUE if the cell is currently being edited.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetItem(const GV_ITEM* pItem)</CODE></TD>
    <TD width="50%">Sets the contents of a cell with the values from the <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A> 
      structure. Note that the value of the mask field will determine which 
      values are actually changed (cf. CListCtrl::SetItem).</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetItem(GV_ITEM* pItem)</CODE></TD>
    <TD width="50%">Fills the <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A> 
      structure with values from the specified cell. Note that the value of the 
      mask field will determine which values are actually retrieved (cf. 
      CListCtrl::GetItem). </TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetItemText(int nRow, int nCol, LPCTSTR 
      str)</CODE></TD>
    <TD width="50%">Sets the text for the given cell. Returns TRUE on 
    success</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>virtual CString GetItemText(int nRow, int 
      nCol)</CODE> </TD>
    <TD width="50%">Gets the text for the given cell. This function is virtual 
      in order to aid extensibility. No more messing around with LVN_GETDISPINFO 
      messages or string pooling!</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetItemData(int nRow, int nCol, LPARAM 
      lParam)</CODE> </TD>
    <TD width="50%">Sets the lParam (user-defined data) field for the given 
      cell. Returns TRUE on success. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>LPARAM GetItemData(int nRow, int nCol) const</CODE> 
    </TD>
    <TD width="50%">Gets the lParam (user-defined data) field for the given 
      cell. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetItemImage(int nRow, int nCol, int 
      iImage)</CODE> </TD>
    <TD width="50%">Sets the image index for the given cell. Returns TRUE on 
      success. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetItemImage(int nRow, int nCol) const</CODE> 
</TD>
    <TD width="50%">Gets the image index for the given cell.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetItemState(int nRow, int nCol, UINT 
      state)</CODE> </TD>
    <TD width="50%">Sets the state of the given cell. Returns TRUE on success. 
      See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>UINT GetItemState(int nRow, int nCol) const</CODE> 
    </TD>
    <TD width="50%">Gets the state of the given cell. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetItemFormat(int nRow, int nCol, UINT 
      nFormat)</CODE> </TD>
    <TD width="50%">Sets the format of the given cell. Returns TRUE on 
      success. Default implementation of cell drawing uses CDC::DrawText, so any 
      of the DT_* formats are available. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>UINT GetItemFormat(int nRow, int nCol) const</CODE> 
    </TD>
    <TD width="50%">Gets the format of the given cell (default returns a 
      CDC::DrawText DT_* format). See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetSelectedCount()</CODE> </TD>
    <TD width="50%">Gets the number of selected cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>CCellID GetFocusCell()</CODE></TD>
    <TD width="50%">Gets the cell with the focus. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#CCellID">CCellID<A>.</A></TD></TR>
  <TR>
    <TD width="50%"><CODE>CCellID SetFocusCell(CCellID cell);<BR>CCellID 
      SetFocusCell(int nRow, int nCol);</CODE> </TD>
    <TD width="50%">Sets the cell with the focus</TD></TR><A name=CellColours></A>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetItemBkColour(int nRow, int nCol, &nbsp; 
      COLORREF cr = CLR_DEFAULT)</CODE></TD>
    <TD width="50%">Sets the background colour of the given cell. Returns TRUE 
      on success. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetItemBkColour(int nRow, int nCol) 
      const</CODE></TD>
    <TD width="50%">Gets the background colour of the given cell. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetItemFgColour(int nRow, int nCol, &nbsp; 
      COLORREF cr = CLR_DEFAULT)</CODE></TD>
    <TD width="50%">Sets the foreground colour of the given cell. Returns TRUE 
      on success. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>COLORREF GetItemFgColour(int nRow, int nCol) 
      const</CODE></TD>
    <TD width="50%">Gets the foreground colour of the given cell. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SetItemFont(int nRow, int nCol, LOGFONT* 
      lf)</CODE></TD>
    <TD width="50%">Sets the font of the given cell. Returns TRUE on success. 
      See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR>
    <TD width="50%"><CODE>LOGFONT* GetItemFont(int nRow, int nCol) 
      const</CODE> </TD>
    <TD width="50%">Gets the font of the given cell. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#GV_ITEM">GV_ITEM</A>.</TD></TR>
  <TR>
    <TD width="50%"><CODE>BOOL IsItemEditing(int nRow, int nCol)</CODE></TD>
    <TD width="50%">Returns TRUE if the cell is currently being edited.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnsureVisible(CCellID &amp;cell)</CODE></TD>
    <TD width="50%">Ensures that the specified cell is visible.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsCellVisible(CCellID &amp;cell) const<BR>BOOL 
      IsCellVisible(CCellID cell) const</CODE></TD>
    <TD width="50%">Returns TRUE if the cell is visible.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsCellEditable(CCellID &amp;cell) const<BR>BOOL 
      IsCellEditable(CCellID cell) const</CODE></TD>
    <TD width="50%">Returns TRUE if the cell is editable.</TD></TR>
  <TR>
    <TD width="50%"><CODE>BOOL IsCellSelected(CCellID &amp;cell) const<BR>BOOL 
      IsCellSelected(CCellID cell) const</CODE></TD>
    <TD width="50%">Returns TRUE if the cell is selected</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnsureVisible(int nRow, int nCol)</CODE></TD>
    <TD width="50%">Ensures that the specified cell is visible.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsCellFixed(int nRow, int nCol)</CODE> </TD>
    <TD width="50%">Returns TRUE if the given cell is a fixed cell</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetDefCellHeight() const</CODE> </TD>
    <TD width="50%">Returns the default cell height (for new cells)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetDefCellHeight(int nHeight)</CODE> </TD>
    <TD width="50%">Sets the default cell height (for new cells). This will be 
      overridden if <CODE>SetFont</CODE> is called</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetDefCellWidth() const</CODE> </TD>
    <TD width="50%">Returns the default cell width (for new cells)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetDefCellWidth(int nWidth)</CODE> </TD>
    <TD width="50%">Sets the default cell width (for new cells). This will be 
      overridden if <CODE>SetFont</CODE> is called</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetDefCellWidth() const</CODE> </TD>
    <TD width="50%">Returns the default cell internal margin</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetDefCellMargin(int nMargin)</CODE> </TD>
    <TD width="50%">Sets the default cell internal margin.</TD></TR></TBODY></TABLE>
<H2><A name=Operations>Operations</A></H2>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>int InsertColumn(LPCTSTR strHeading, &nbsp; UINT 
      nFormat, int nColumn = -1)</CODE></TD>
    <TD width="50%">Inserts a column at the position given by nCol, or at the 
      end of all columns if nCol is &lt; 0. <B>strHeading</B> is the column 
      heading and <B>nFormat</B> the format. Returns the position of the 
      inserted column.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int InsertRow(LPCTSTR strHeading, int nRow = 
      -1)</CODE> </TD>
    <TD width="50%">Inserts a row at the position given by nRow, or at the end 
      of all rows if nRow is &lt; 0. <B>strHeading</B> is the row heading. The 
      format of each cell in the row will be that of the cell in the first row 
      of the same column. Returns the position of the inserted row.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL DeleteColumn(int nColumn)</CODE> </TD>
    <TD width="50%">Deletes column "nColumn", return TRUE on success.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL DeleteRow(int nRow)</CODE> </TD>
    <TD width="50%">Deletes row "nRow", return TRUE on success.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL DeleteAllItems()</CODE> </TD>
    <TD width="50%">Deletes all rows and contents in the grid.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL DeleteNonFixedRows()</CODE> </TD>
    <TD width="50%">Deletes all non-fixed rows in the grid.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL AutoSizeRow(int nRow, BOOL bResetScroll = 
      TRUE)</CODE> </TD>
    <TD width="50%">Auto sizes the row to the size of the largest item. If 
      <I>bResetScroll</I> is TRUE then the scroll bars will be reset.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL AutoSizeColumn(int nCol, UINT nAutoSizeStyle = 
      GVS_DEFAULT, BOOL bResetScroll = TRUE)</CODE> </TD>
    <TD width="50%">Auto sizes the column to the size of the largest item. 
      <I>nAutoSizeStyle</I> sets the way the autosize will occur (see <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#AutosizeOption">AutoSizing 
      options</A>). If <I>bResetScroll</I> is TRUE then the scroll bars will be 
      reset.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void AutoSizeRows()</CODE> </TD>
    <TD width="50%">Auto sizes all rows.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void AutoSizeColumns(UINT nAutoSizeStyle = 
      GVS_DEFAULT)</CODE> </TD>
    <TD width="50%">Auto sizes all columns. <I>nAutoSizeStyle</I> sets the way 
      the autosize will occur. (see <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#AutosizeOption">AutoSizing 
      options</A>) </TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void AutoSize(UINT nAutoSizeStyle = 
      GVS_DEFAULT)</CODE> </TD>
    <TD width="50%">Auto sizes all rows and columns. <I>nAutoSizeStyle</I> 
      sets the way the autosize will occur. (see <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#AutosizeOption">AutoSizing 
      options</A>)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void ExpandColumnsToFit(BOOL 
      bExpandFixed=TRUE)</CODE> </TD>
    <TD width="50%">Expands the column widths to fit the grid area. If 
      <I>bExpandFixed</I> is TRUE then fixed columns will be modified, otherwise 
      they will not be affected.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void ExpandLastColumn()</CODE> </TD>
    <TD width="50%">Expands the last column width to fill any remaining grid 
      area.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void ExpandRowsToFit(BOOL bExpandFixed=TRUE)</CODE> 
    </TD>
    <TD width="50%">Expands the row heights to fit the grid area. If 
      <I>bExpandFixed</I> is TRUE then fixed rows will be modified, otherwise 
      they will not be affected.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void ExpandToFit(BOOL bExpandFixed = TRUE)</CODE> 
</TD>
    <TD width="50%">Expands the rows and columns to fit the grid area. If 
      <I>bExpandFixed</I> is TRUE then fixed cells will be modified, otherwise 
      they will not be affected.&lt;</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>CSize GetTextExtent(int nRow, int nCol, LPCTSTR 
      str)</CODE> </TD>
    <TD width="50%">Gets the size of the text pointed to by str for the given 
      cell </TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>CSize GetCellTextExtent(int nRow, int nCol)</CODE> 
    </TD>
    <TD width="50%">Gets the size of the text of the given cell </TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetRedraw(BOOL bAllowDraw, &nbsp; BOOL 
      bResetScrollBars = FALSE)</CODE> </TD>
    <TD width="50%">Stops/starts redraws on things like changing the number of 
      rows and columns and autosizing, but not for user-intervention such as 
      resizes.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL RedrawCell(int nRow, int nCol, CDC* pDC = 
      NULL)</CODE> </TD>
    <TD width="50%">Redraws the given cell. Drawing will be via the pDC if one 
      is supplied.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL RedrawCell(const CCellID&amp; cell, CDC* pDC = 
      NULL)</CODE> </TD>
    <TD width="50%">Redraws the given cell. Drawing will be via the pDC if one 
      is supplied.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL RedrawRow(int row)</CODE> </TD>
    <TD width="50%">Redraws the given row.</TD></TR>
  <TR>
    <TD width="50%"><CODE>BOOL RedrawColumn(int col)</CODE> </TD>
    <TD width="50%">Redraws the given column</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL Refresh()</CODE> </TD>
    <TD width="50%">Redraws the entire grid.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>CCellRange GetCellRange()</CODE> </TD>
    <TD width="50%">Gets the range of cells for the entire grid. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#CCellRange">CCellRange<A>.</A></TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetSelectedRange(const CCellRange&amp; 
      Range,&nbsp; BOOL bForceRepaint = FALSE);</CODE> </TD>
    <TD width="50%">Sets the range of selected cells. See also <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#CCellRange">CCellRange<A>.</A></TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetSelectedRange(int nMinRow, int nMinCol, 
      &nbsp; int nMaxRow, int nMaxCol, &nbsp; BOOL bForceRepaint = 
      FALSE);</CODE> </TD>
    <TD width="50%">Sets the range of selected cells.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsValid(int nRow, int nCol)</CODE> </TD>
    <TD width="50%">Returns TRUE if the given row and column is valid.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsValid(const CCellID&amp; cell)</CODE> </TD>
    <TD width="50%">Returns TRUE if the given cell is valid.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL IsValid(const CCellRange&amp; range)</CODE> </TD>
    <TD width="50%">Returns TRUE if the given cell range is valid.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>CCellID GetNextItem(CCellID&amp; cell, int nFlags) 
      const</CODE> </TD>
    <TD width="50%">Searches for a cell that has the specified properties and 
      that bears the specified relationship to a given item. (See also 
      CListCtrl::GetNextItem and <A 
      href="http://www.codeproject.com/miscctrl/gridctrl.asp#CellSearch">Cell 
      Searching options</A>)</TD></TR></TBODY></TABLE>
<H2><A name=Sorting>Sorting</A></H2>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetHeaderSort(BOOL bSortOnClick = TRUE)</CODE> 
    </TD>
    <TD width="50%">Sets whether or not rows are sorted on column header 
      clicks in ListMode.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetHeaderSort()</CODE> </TD>
    <TD width="50%">Gets whether or not rows are sorted on column header 
      clicks in ListMode.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>SetSortColumn(int nCol</CODE></TD>
    <TD width="50%">Sets the index of the currently sorted column.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>int GetSortColumn()</CODE></TD>
    <TD width="50%">Gets the index of the currently sorted column.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetSortAscending(BOOL bAscending)</CODE></TD>
    <TD width="50%">Sets whether the current sort column is sorted 
    ascending.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetSortAscending()</CODE></TD>
    <TD width="50%">Gets whether the current sort column is sorted 
    ascending.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SortTextItems(int nCol, BOOL bAscending, LPARAM 
      data = 0)</CODE> </TD>
    <TD width="50%">Sorts the grid on the given column based on cell text. 
      Returns TRUE on success.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SortItems(int nCol, BOOL bAscending, LPARAM 
      data = 0)</CODE> </TD>
    <TD width="50%">Sorts the grid on the given column based using the current 
      comparison function. If no function has been specified then the rows are 
      sorted by text. Returns TRUE on success. <BR>See also 
    SetCompareFunction()</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetCompareFunction(PFNLVCOMPARE 
      pfnCompare)</CODE> </TD>
    <TD width="50%">Sets the callback function that will be used to sort the 
      grid rows. See below for more details.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL SortItems(PFNLVCOMPARE pfnCompare, int nCol, 
      &nbsp; BOOL bAscending, LPARAM data = 0)</CODE> </TD>
    <TD width="50%">Sorts the grid on the given column using the supplied 
      compare function pfnCompare. See CListCtrl::SortItems for information in 
      the form of this function. Returns TRUE on success.</TD></TR></TBODY></TABLE>
<P>Sorting is achieved by calling one of the variants of <CODE>SortItems</CODE>, 
<CODE>SortTextItems</CODE>, or by the user clicking on a column header when in 
list mode. 
<P>The simplest way to handle sorting is to set the function that will be used 
in cell comparisons (by calling <CODE>SetCompareFunction</CODE>) and then 
calling <CODE>SortItems(int nCol, BOOL bAscending, LPARAM data = 0)</CODE>. 
<I>nCol</I> is the column to sort, <EM>bAscending</EM> sets whether the sort is 
in ascending or descending order, and <I>data</I> is application specific data 
that will be passed to the comparison function. 
<P>The comparison function must be a global or static function with the form 
</P><PRE>int CALLBACK pfnCellCompare(LPARAM lParam1, LPARAM lParam2, LPARAM lParamSort)</PRE>
<P><I>lParam1</I> and <I>lParam2</I> will be <CODE>CGridCellBase</CODE> 
pointers, and <I>lParamSort</I> will be the application specific data you pass 
into the <CODE>SortItems</CODE> function as the <I>data</I> parameter. The 
function must return -1 if the first cell contains a value less than the second 
cell; 0 if they are equal, otherwise 1. 
<P>An example of a sort comparison function is as follows: </P><PRE>int CALLBACK MyClass::pfnCellNumericCompare(LPARAM lParam1, LPARAM lParam2, LPARAM lParamSort)
{
	CGridCellBase* pCell1 = (CGridCellBase*) lParam1;
	CGridCellBase* pCell2 = (CGridCellBase*) lParam2;
	if (!pCell1 || !pCell2) return 0;

	int nValue1 = _ttol(pCell1-&gt;GetText());
	int nValue2 = _ttol(pCell2-&gt;GetText());

	if (nValue1 &lt; nValue2)
		return -1;
	else if (nValue1 == nValue2)
		return 0;
	else
		return 1;
}</PRE>
<P>Two functions have been provided for your convenience: </P><PRE>int CALLBACK CGridCtrl::pfnCellTextCompare(LPARAM lParam1, LPARAM lParam2, LPARAM lParamSort)
int CALLBACK CGridCtrl::pfnCellNumericCompare(LPARAM lParam1, LPARAM lParam2, LPARAM lParamSort)
</PRE>
<P>These sort by Text value and by numeric value (using <CODE>itoa</CODE> 
respectively. To set the comparison function for the grid simply call: </P><PRE>m_Grid.SetCompareFunction(CGridCtrl::pfnCellNumericCompare);</PRE>
<P>If the comparison function is set as NULL, 
<CODE>CGridCtrl::pfnCellTextCompare</CODE> will be used by default. 
<H2><A name=Printing>Printing</A></H2>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>void EnableWysiwygPrinting(BOOL bEnable = 
      TRUE)</CODE> </TD>
    <TD width="50%">Set WYSIWYG Printing </TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetWysiwygPrinting()</CODE> </TD>
    <TD width="50%">Returns TRUE if WYSIWYG Printing is set</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void Print()</CODE> </TD>
    <TD width="50%">Prints the grid control on the user selected device. 
      (Useful where the control is used in a dialog)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>virtual void OnBeginPrinting(CDC *pDC, CPrintInfo 
      *pInfo)</CODE> </TD>
    <TD width="50%">Used in a Doc/View environment. Call in your CView dervied 
      class' OnBeginPrinting.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>virtual void OnPrint(CDC *pDC, CPrintInfo 
      *pInfo)</CODE> </TD>
    <TD width="50%">Used in a Doc/View environment. Call in your CView dervied 
      class' OnPrint.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>virtual void OnEndPrinting(CDC *pDC, CPrintInfo 
      *pInfo)</CODE> </TD>
    <TD width="50%">Used in a Doc/View environment. Call in your CView dervied 
      class' OnEndPrinting.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetShadedPrintOut(BOOL bEnable = TRUE)</CODE> 
    </TD>
    <TD width="50%">If TRUE, colored cells will print as-is. If FALSE, all 
      text prints as black on white.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>BOOL GetShadedPrintOut()</CODE> </TD>
    <TD width="50%">Get's whether or not cells are printed shaded or 
  as-is.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void SetPrintMarginInfo(int nHeaderHeight, int 
      nFooterHeight, int nLeftMargin, int nRightMargin, int nTopMargin, int 
      nBottomMargin, int nGap)</CODE></TD>
    <TD width="50%">Set printing margin info.</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>void GetPrintMarginInfo(int &amp;nHeaderHeight, int 
      &amp;nFooterHeight, int &amp;nLeftMargin, int &amp;nRightMargin, int 
      &amp;nTopMargin, int &amp;nBottomMargin, int &amp;nGap)</CODE> </TD>
    <TD width="50%">Get printing margin info.</TD></TR></TBODY></TABLE>
<H2><A name=Structures>Structures, defines and Messages</A></H2>
<H3>The CGridCellBase class</H3>
<P>This class is the base class for all grid cell classes, and holds the 
information for each cell. The class also defines a number of methods that are 
called by the grid itself, such as drawing and printing. Almost all methods and 
functions are virtual and this class is not designed to be used directly - 
rather it should be derived from. The default class <CODE>CGridCell</CODE> is 
derived from <CODE>CGridCellBase</CODE> and is used by the Grid control as the 
default cell class.</P>
<H4>Attributes</H4><PRE>virtual void SetText(LPCTSTR szText);
virtual void SetImage(int nImage);
virtual void SetData(LPARAM lParam);
virtual void SetState(DWORD nState);
virtual void SetFormat(DWORD nFormat);
virtual void SetTextClr(COLORREF clr);
virtual void SetBackClr(COLORREF clr);
virtual void SetFont(const LOGFONT* plf);
virtual void SetGrid(CGridCtrl* pGrid);
virtual void SetCoords(int nRow, int nColumn);
virtual void SetMargin(UINT nMargin);

virtual LPCTSTR  GetText() const         // returns the text in the cell
virtual LPCTSTR  GetTipText() const      // return alternate tooltip text if you wish 
virtual int      GetImage() const        // returns image index for cell
virtual LPARAM   GetData() const         // returns data associated with cell
virtual DWORD    GetState() const        // returns cell state
virtual DWORD    GetFormat() const       // returns cell format
virtual COLORREF GetTextClr() const      // returns cell text color
virtual COLORREF GetBackClr() const      // returns cell background color
virtual LOGFONT* GetFont() const         // returns cell font as a LOGFONT
virtual CFont*   GetFontObject() const   // returns a CFont object with the cell's font
virtual UINT     GetMargin() const       // returns internal margin for cell
virtual CGridCtrl* GetGrid() const       // returns grid that cell is associated with
virtual CWnd*    GetEditWnd() const      // returns editing window for cell, or NULL
    
virtual BOOL IsEditing() const
virtual BOOL IsFocused()  const 
virtual BOOL IsFixed()    const 
virtual BOOL IsFixedCol() const
virtual BOOL IsFixedRow() const
virtual BOOL IsSelected() const 
virtual BOOL IsReadOnly() const
virtual BOOL IsModified() const
virtual BOOL IsDropHighlighted() const
virtual BOOL IsDefaultFont() const       // TRUE if cell is using default font in grid

virtual CGridCellBase* GetDefaultCell() const;
</PRE>
<H4>Operators</H4><PRE>virtual void operator=(CGridCellBase&amp; cell);</PRE>
<H4>Operations</H4><PRE>virtual void Reset();

virtual BOOL Draw(CDC* pDC, int nRow, int nCol, CRect rect, BOOL bEraseBkgnd = TRUE);
virtual BOOL GetTextRect( LPRECT pRect)     - dimensions of text within cell
virtual BOOL GetTipTextRect( LPRECT pRect)  - boundary for tooltips
virtual CSize GetTextExtent(LPCTSTR str)    - size of text
virtual CSize GetCellExtent(CDC* pDC)       - size of cell

// start and stop cell editing
virtual BOOL Edit(int nRow, int nCol, CRect rect, CPoint point, UINT nID, UINT nChar) 
virtual void EndEdit()

// Validates the results of an edit. If "str" is not a valid value for the
// cell then  return FALSE to have the edit rejected
virtual BOOL ValidateEdit(LPCTSTR str);

virtual BOOL PrintCell(CDC* pDC, int nRow, int nCol, CRect rect);

// This can ONLY be called by CGridCellBase derived classes, and not CGridCellBase itself.
LRESULT SendMessageToParent(int nRow, int nCol, int nMessage);
</PRE>
<H4>Overridables</H4><PRE>virtual void OnEndEdit();
virtual void OnMouseEnter();
virtual void OnMouseOver();
virtual void OnMouseLeave();
virtual void OnClick( CPoint PointCellRelative);
virtual void OnClickDown( CPoint PointCellRelative);
virtual void OnRClick( CPoint PointCellRelative);
virtual void OnDblClick( CPoint PointCellRelative);
virtual BOOL OnSetCursor();
</PRE>
<P>This makes customising cells extremely simple. To install a new type of 
derived class for your grid cells, you can either override 
<CODE>CGridCtrl::CreateCell</CODE> and create your derived 
<CODE>CGridCellBase</CODE> cells, or you can use 
<CODE>CGridCtrl::SetCellType</CODE> and 
<CODE>CGridCtrl::SetDeafaultCellType</CODE> to automate this. 
<P>Simply create a new cell class derived from <CODE>CGridCellBase</CODE> or 
<CODE>CGridCell</CODE> (eg. <CODE>CMyGridCell</CODE>), and then replace the 
cells in the grid by calling </P><PRE>MyGrid.SetCellType(row, column, RUNTIME_CLASS(CMyGridCell));</PRE>
<P>The cell at (row,column) will now be of type <CODE>CMyGridCell</CODE>. 
<H3><A name=CCellID>The CGridCell class<A></H3>
<P>This class is derived from <CODE>CGridCellBase</CODE> and provides a default 
implementation for use with <CODE>CGridCtrl</CODE>. 
<H3><A name=CCellID>The CCellID class<A></H3>This is a handy helper class used 
to reference individual cells. All members are public. This class is adapted 
from Joe Willcoxsons original implementation. <PRE>class CCellID
{    
public:
    int row, col; // The zero based row and column of the cell.

    CCellID(int nRow = -1, int nCol = -1)

    int IsValid();
    int operator==(const CCellID&amp; rhs);
    int operator!=(const CCellID&amp; rhs);
}
</PRE>
<H3><A name=CCellRange>The CCellRange class</A></H3>
<P>This is a handy helper class used to reference cell ranges. This class is 
adapted from Joe Willcoxsons original implementation. </P><PRE>class CCellRange
{ 
public:
    CCellRange(int nMinRow = -1, int nMinCol = -1, int nMaxRow = -1, int nMaxCol = -1);
    void Set(int nMinRow = -1, int nMinCol = -1, int nMaxRow = -1, int nMaxCol = -1);
    
    int  IsValid() const;
    int  InRange(int row, int col) const;       // Is the row/col in the range?
    int  InRange(const CCellID&amp; cellID) const;  // is the cell in the range?
    
    CCellID  GetTopLeft() const;                // Get topleft cell in range
    CCellRange Intersect(const CCellRange&amp; rhs) const;&nbsp;
                                                // Returns the intersection of
                                                // two cell ranges

    int GetMinRow() const;                      // Self explanatory
    void SetMinRow(int minRow);
    int GetMinCol() const;
    void SetMinCol(int minCol);
    int GetMaxRow() const;
    void SetMaxRow(int maxRow);
    int GetMaxCol() const;
    void SetMaxCol(int maxCol);

    int GetRowSpan() const;                    // Number of rows spanned
    int GetColSpan() const;                    // Number of columns spanned
    
    void operator=(const CCellRange&amp; rhs);
    int  operator==(const CCellRange&amp; rhs);
    int  operator!=(const CCellRange&amp; rhs);
}
</PRE>
<P><A name=GV_ITEM>The GV_ITEM structure<A>. This structure is used for 
Get/SetItem calls. </P><PRE>typedef struct _GV_ITEM {
        int      row,col;   // Row and Column of item
        UINT     mask;      // Mask for use in getting/setting cell data
        UINT     state;     // cell state (focus/hilighted etc)
        UINT     nFormat;   // Format of cell. Default imaplentation used CDC::DrawText formats
        CString  szText;    // Text in cell
        int      iImage;    // index of the list view item&#8217;s icon
        COLORREF crBkClr;   // Background colour (or CLR_DEFAULT)
        COLORREF crFgClr;   // Forground colour (or CLR_DEFAULT)
        LPARAM   lParam;    // 32-bit value to associate with item
        LOGFONT  lfFont;    // cell font
} GV_ITEM;</PRE><A name=GVL_Values>Grid line or scroll bar selection</A> <PRE>GVL_NONE       - No grid lines
GVL_HORZ       - Horizontal lines only
GVL_VERT       - Vertical lines only
GVL_BOTH       - Both vertical and horizontal lines
</PRE><A name=AutosizeOption>Autosizing options</A> <PRE>GVS_DEFAULT    - default 
GVS_HEADER     - Size using column fixed cells data only
GVS_DATA       - Size using column non-fixed cells data only
GVS_BOTH       - Size using column fixed and non-fixed
</PRE><A name=CellMask>Cell data mask</A> <PRE>GVIF_TEXT       - Cell text will be accessed
GVIF_IMAGE      - Cell image number will be accessed
GVIF_PARAM      - Cell user data (lParam) will be accessed
GVIF_STATE      - Cell state will be accessed
GVIF_BKCLR      - Cell background colour will be accessed
GVIF_FGCLR      - Cell foreground colour will be accessed
GVIF_FORMAT     - Cell format field will be accessed
GVIF_FONT       - Cell logical font will be accessed
GVIF_MARGIN     - Cell margin information will be accessed 
GVIF_ALL        - All information will be accessed 
</PRE><A name=CellState>Cell states</A> <PRE>GVIS_FOCUSED      - Cell has focus
GVIS_SELECTED     - Cell is selected
GVIS_DROPHILITED  - Cell is drop highlighted
GVIS_READONLY     - Cell is read-only and cannot be edited
GVIS_FIXED        - Cell is fixed
GVIS_FIXEDROW     - Cell is part of a fixed row
GVIS_FIXEDCOL     - Cell is part of a fixed column
GVIS_MODIFIED     - Cell has been modified
</PRE><A name=CellSearch>Cell Searching options</A> <PRE>GVNI_FOCUSED      - Search for focus cell
GVNI_SELECTED     - Search for selected cells
GVNI_DROPHILITED  - Search for drop highlighted cells
GVNI_READONLY     - Search for read-only cells
GVNI_FIXED        - Search for fixed cells 
GVNI_MODIFIED     - Search for modified cells

GVNI_ABOVE        - Search above initial cell
GVNI_BELOW        - Search below initial cell
GVNI_TOLEFT       - Search to the left of the initial cell
GVNI_TORIGHT      - Search to the right of the initial cell
GVNI_ALL          - Search all cells in the grid starting from the given cell
GVNI_AREA         - Search all cells below and to the right of the given cell
</PRE><A name=Messages>Notification messages</A> <PRE>GVN_BEGINDRAG       - Sent when dragging starts
GVN_BEGINLABELEDIT  - Sent when inplace editing starts
GVN_ENDLABELEDIT    - Sent when inplace editing stops
GVN_SELCHANGING     - Sent just before cell selection changes
GVN_SELCHANGED      - Sent after cell selection changes
GVN_GETDISPINFO     - A request for cell information when the grid is in virtual mode
GVN_ODCACHEHINT     - Cache hint when in virtual mode
</PRE>
<P>These messages are exactly the same as their LVN_... counterparts, except 
they use an NM_GRIDVIEW structure: </P><PRE>typedef struct tagNM_GRIDVIEW { 
    NMHDR hdr; 
    int   iRow; 
    int   iColumn; 
} NM_GRIDVIEW;
</PRE>
<H2><A name=Overrides>Protected overridable functions</A></H2>
<P>These functions have been made virtual to aid extensiblity. 
<P><B>Printing</B> - called in OnPrint. </P><PRE>virtual void PrintColumnHeadings(CDC *pDC, CPrintInfo *pInfo);
virtual void PrintHeader(CDC *pDC, CPrintInfo *pInfo); 
virtual void PrintFooter(CDC *pDC, CPrintInfo *pInfo);
virtual void PrintRowButtons(CDC *pDC, CPrintInfo* pInfo);
</PRE>
<P><B>Drag n' drop</B> </P><PRE>virtual CImageList* CreateDragImage(CPoint *pHotSpot) - No longer necessary but I 
                                                        thought the code was cool so
                                                        kept it :).
</PRE>
<P><B>Mouse Clicks</B> </P><PRE>virtual void OnFixedColumnClick(CCellID&amp; cell);
virtual void OnFixedRowClick(CCellID&amp; cell);
</PRE>
<P><B>Editing</B> </P><PRE>virtual void OnEditCell(int nRow, int nCol, CPoint point, UINT nChar) - Starting edit
virtual void OnEndEditCell(int nRow, int nCol, CString str)      - ending edit
virtual void CreateInPlaceEditControl(CRect&amp; rect, DWORD dwStyle, int nRow, int nCol,
                                      LPCTSTR szText, int nChar) - Create the inplace edit control
</PRE>
<P><B>Drawing</B> </P><PRE>virtual void OnDraw(CDC&amp; origDC);  - Draws everything
</PRE>
<P><B>Construction and Cleanup</B> </P><PRE>virtual CGridCellBase* CreateCell(int nRow, int nCol) - Creates a new cell and 
                                                        initialises it.
virtual void DestroyCell(int nRow, int nCol)          - Destroys a cell and performs any 
                                                        cleanup necessary
</PRE>
<H2><A name=Clipboard>Clipboard</A></H2>
<P>A number of Clipboard functions have been included.<BR>
<TABLE cellSpacing=0 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD width="50%"><CODE>virtual void OnEditCut()</CODE> </TD>
    <TD width="50%">Copies contents of selected cells to clipboard and deletes 
      the contents of the selected cells. (Ctrl-X)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>virtual void OnEditCopy()</CODE> </TD>
    <TD width="50%">Copies contents of selected cells to clipboard. 
  (Ctrl-C)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>virtual void OnEditPaste()</CODE> </TD>
    <TD width="50%">Pastes the contents of the clipboard to the grid. 
    (Ctrl-V)</TD></TR>
  <TR vAlign=top>
    <TD width="50%"><CODE>virtual void OnEditSelectAll()</CODE> </TD>
    <TD width="50%">Not actually a clipboard function, but handy nevertheless. 
      This routine selects all cells in the grid. (Ctrl-A)</TD></TR></TBODY></TABLE>
<H2><A name=EditValidate>Cell Editing and Validation</A></H2>
<P>There are several ways you can control whether or not cells can be edited, or 
indeed whether or not changes to cells should be accepted or rejected. 
<P>The simplest is to use <CODE>SetEditable(BOOL)</CODE>. This determines 
whether or not the cells in the grid can be edited. Finer scale control can be 
achieved by setting the <CODE>GVIS_READONLY</CODE> flag on a particular cell: 
</P><PRE>int row = 1;
int col = 10;
m_Grid.SetItemState(row,col, m_Grid.GetItemState(row,col) | GVIS_READONLY);</PRE>
<P>Further control can be achieved by handling the 
<CODE>GVN_BEGINLABELEDIT</CODE> message. If the return value for this message is 
&lt; 0 then the edit attempt for the given cell will be rejected and the cell 
will be treated as read-only. This message is sent each time an edit attempt is 
made on a cell. 
<P>To handle the message, add a handler in your main window: </P><PRE>BEGIN_MESSAGE_MAP(CGridCtrlDemoDlg, CDialog)
	...
	// Add a handler
	ON_NOTIFY(GVN_ENDLABELEDIT, IDC_GRID, OnGridEndEdit)
END_MESSAGE_MAP()

...

// GVN_ENDLABELEDIT
void CGridCtrlDemoDlg::OnGridStartEdit(NMHDR *pNotifyStruct, LRESULT* pResult)
{
    NM_GRIDVIEW* pItem = (NM_GRIDVIEW*) pNotifyStruct;
    
    // AllowCellToBeEdited is a fictional routine that should return TRUE if you
    // want to allow the cell to be edited.
    BOOL bAllowEdit = AllowCellToBeEdited(pItem-&gt;iRow, pItem-&gt;iColumn);

    *pResult = (bAllowEdit)? 0 : -1;
}
</PRE>
<P>Accepting or rejecting the new edited value for the cell can be achieved by 
handling the <CODE>GVN_ENDLABELEDIT</CODE> message in the same way </P><PRE>// GVN_ENDLABELEDIT
void CGridCtrlDemoDlg::OnGridEndEdit(NMHDR *pNotifyStruct, LRESULT* pResult)
{
    NM_GRIDVIEW* pItem = (NM_GRIDVIEW*) pNotifyStruct;
    
    // AcceptChange is a fictional routine that should return TRUE if you
    // want to accept the new value for the cell.
    BOOL bAcceptChange = AcceptChange(pItem-&gt;iRow, pItem-&gt;iColumn);

    *pResult = (bAcceptChange)? 0 : -1;
}
</PRE>
<P>The final validation method you can use is to derive a new 
<CODE>CGridCellBase</CODE> class and override the <CODE>ValidateEdit</CODE> 
method. If this method returns TRUE then the edit is accepted, otherwise the 
edit is rejected. 
<H2><A name=Acknowledgements>Acknowledgements</A></H2>
<P>This would not have been possible without the following authors making their 
code freely available: 
<UL>
  <LI><A href="mailto:chinajoe@aol.com">Joe Willcoxson</A>: Joe's original code 
  spurred this project on, and provided the basic structure of this grid 
  control. 
  <LI><A href="mailto:keithr@europa.com">Keith Rule</A>: Keith provided a neat 
  CMemDC class to make flicker free display simple, and provided sample OLE 
  copy/paste/drag/drop code. 
  <LI><A href="mailto:rreddy@braintech.com">Ravi Reddy</A>: I used a derivation 
  of Ravi's listview printing code. 
  <LI><A href="mailto:zafir@home.com">Zafir Anjum</A>: Provided the starting 
  point for my CInPlaceEdit, the sorting routines and the TitleTip code. 
  <LI>Eric Woodruff, Brian V. Shifrin, Scot Reed, Aqiruse, Ken Bertelson, Martin 
  Daly for updates to the version 2.X classes - plus all the dozens that helped 
  with previous versions. 
  <LI>All those who freely contribute code to one another</A>: Without you all I 
  would not have been able to write this. 
  <LI>All those who sent in bug reports, suggestions, improvements and 
  encouragement. Thank you!</LI></UL>
<H2><A name=History>History</A></H2>
<TABLE cellPadding=5 cellSpacing=5 width="90%">
  <TBODY>
  <TR vAlign=top>
    <TD noWrap>Version</TD>
    <TD noWrap>Date</TD>
    <TD>Comments</TD></TR>
  <TR vAlign=top>
    <TD noWrap>1.0 - 1.13</TD>
    <TD noWrap>20 Feb 1998 - 6 May 1999</TD>
    <TD>First release version. Progressed from being a basic grid based on the 
      original WorldCom Grid control written by Joe Willcoxson 
      (mailto:chinajoe@aol.com, http://users.aol.com/chinajoe) to something a 
      little more feature rich. Rewritten so many times I doubt there is a 
      single line of Joe's code left. Many, many, MANY people sent in bug 
      reports and fixes. Thank you all. </TD></TR>
  <TR vAlign=top>
    <TD noWrap>2.0</TD>
    <TD noWrap>16 Feb 2000</TD>
    <TD>Rewritten to make the grid more object oriented, in that the CGridCell 
      class now takes care of cell-specific tasks. This makes the code more 
      robust, but more importantly it allows the simple insertion of other types 
      of cells. Most of the bugs in the previous version have been fixed, 
      especially the "ExpandToFit" functions and the cell selection/focus. I 
      expect I've introduced a bunch more :)</TD></TR>
  <TR vAlign=top>
    <TD noWrap>2.01</TD>
    <TD noWrap>23 Feb 2000</TD>
    <TD>Fixes by Eric Woodruff, &lt;Eric_Woodruff@compuserve.com&gt;<BR>Minor 
      MemDC fix, In-place edit WM_KILLFOCUS, "PrintCell" added to CGridCell, 
      plus changes to CGridCell::Draw. Added GetCellTextExtent, SetItemTextFmt 
      to CGridCtrl + better print support. OnRButtonUp handler. various 
      Clipboard and key handling fixes. Search for EFW. </TD></TR>
  <TR vAlign=top>
    <TD noWrap><A name=New>2.02</A> </TD>
    <TD noWrap>29 Feb 2000</TD>
    <TD>Brian V. Shifrin, Scot Reed<BR>Fixes to reduce flicker, fix font 
      selection bug, Fixed SetFixed[Row/Col]Count bug</TD></TR>
  <TR vAlign=top>
    <TD noWrap>2.10 </TD>
    <TD noWrap>11 Mar 2000 </TD>
    <TD>Ken Bertelson, Aqiruse and Chris Maunder<BR>Titletips now use cell 
      color<BR>More attribute accessor functions, plus previously private 
      functions now public<BR>Additions for virtual CGridCell support of 
      embedded tree &amp; cell buttons implementation<BR>Optional WYSIWYG 
      printing<BR>Awareness of hidden (0 width/height) rows and columns for key 
      movements, cut, copy, paste, and autosizing<BR>CGridCell can make title 
      tips display any text rather than cell text only<BR>Minor vis bug 
      fixes<BR>CGridCtrl now works with CGridCellBase instead of CGridCell. This 
      is a taste of things to come.<BR></TD>
  <TR vAlign=top>
    <TD noWrap>2.11 </TD>
    <TD noWrap>19 May 2000 </TD>
    <TD>Chris Maunder + Co<BR>Increasing fixed cells clashed with selected 
      cells (Ivan Ilinov)<BR>AutoSizeRows obvous bug fixed<BR>OnLButtonDown fix 
      (Ken Bertelson) <BR>ExpandToFit bug fixed (scrollbar space) (Igor 
      Proskuriakov)<BR>List mode selection/deselection fixed<BR>Keyboard cell 
      movement improved. You can now see the cells!<BR>m_nBarState MS madness 
      fixed (Phil K)<BR></TD>
  <TR vAlign=top>
    <TD noWrap>2.12 </TD>
    <TD noWrap>26 May 2000 </TD>
    <TD>Martin Richter's fixes:<BR>If using TRY/CATCH (winCE) instead of 
      try/catch (win32), e-&gt;Delete is not called<BR>EnsureVisible "fix" was 
      fixed properly.<BR></TD>
  <TR vAlign=top>
    <TD noWrap>2.13 </TD>
    <TD noWrap>28 May 2000 </TD>
    <TD>Chris Maunder, Martin Richter, Ken Bertelson<BR>AutoSizeColumn works 
      on either column header, data or both<BR>EnsureVisible. The saga 
      continues.<BR>Rewrote exception handling<BR>Added the Get/EnableColumnHide 
      and Get/EnableRowHide functions<BR></TD>
  <TR vAlign=top>
    <TD noWrap>2.20</TD>
    <TD noWrap>29 July 2000 </TD>
    <TD>Font storage optimised (suggested by Martin Richter)<BR>AutoSizeColumn 
      works on either column header, data or both<BR>EnsureVisible. The saga 
      continues... (Ken)<BR>Rewrote exception handling<BR>Added TrackFocusCell 
      and FrameFocusCell properties, as well as ExpandLastColumn (suggested by 
      Bruce E. Stemplewski).<BR>InsertColumn now allows you to insert columns at 
      the end of the column range (David Weibel)<BR>Shift-cell-selection more 
      intuitive<BR>API change: Set/GetGridColor now Set/GetGridLineColor<BR>API 
      change: Set/GetBkColor now Set/GetGridBkColor<BR>API change: 
      Set/GetTextColor, Set/GetTextBkColor depricated <BR>API change: 
      Set/GetFixedTextColor, Set/GetFixedBkColor depricated <BR>Stupid 
      DDX_GridControl workaround removed.<BR>Added "virtual mode" via 
      Set/GetVirtualMode<BR>Added SetCallbackFunc to allow callback functions in 
      virtual mode<BR>Added Set/GetAutoSizeStyle<BR>AutoSize() bug 
      fixed<BR>added GVIS_FIXEDROW, GVIS_FIXEDCOL states<BR>added 
      Get/SetFixed[Row|Column]Selection<BR>cell "Get" methods now const'd. Sorry 
      folks...<BR>GetMouseScrollLines now uses win98/W2K friendly 
      code<BR>WS_EX_CLIENTEDGE style now implicit<BR></TD>
  <TR vAlign=top>
    <TD noWrap>2.21</TD>
    <TD noWrap>30 Aug 2000 </TD>
    <TD>re-jigged OLE initialisation and drag/drop registration<BR>Cut and 
      Paste bug fixed (empty cells not being treated correctly)<BR>Added 
      "bExpandFixed" parameter to Expand*ToFit functions (Hans-Peter 
      Werner)<BR>SetRedraw bug fixed<BR>Resizing 0-width last row and column now 
      works<BR>Fixed CreateCell SetFormat bug (Loic Baudry)<BR>Fixed 
      GetFixedTextColor typo (raybie@Exabyte.COM)<BR>Modified EnableScrollBars 
      calls in Expand*ToFit functions (Simon Hughes)<BR>GetCellFromPt now 
      public<BR>GV_CACHEHINT sent more appropriately, and also sent with -1 
      cellrange at the end of operations (so App can discard data - Martin 
      Richter)<BR>CGridCellBase::operator= checks for NULL font before setting 
      (Martin Richter)<BR>After drag/drop, mouse button was still marked as 
      "down". Fixed.<BR></TD>
  <TR vAlign=top>
    <TD noWrap><A name=New>2.22</A></TD>
    <TD noWrap>1 Jan 2001 </TD>
    <TD>SetModified bug in SetItem (Keith Worden)<BR>ifdef around 
      SetItemTextFmt corrected for win32<BR>Save() bug fixed (row 0 saved 
      twice)<BR>GetTopleftNonFixedCell, GetUnobstructedNonFixedCellRange and 
      GetVisibleNonFixedCellRange have optional parameter to force 
      recalc.<BR>added virtual ValidateEdit.<BR>if the return value from the 
      SendMessage operation for GVN_ENDLABELEDIT or GVN_BEGINLABELEDIT is &lt; 0 
      then the edit, or the attempt to edit (respectively) is rejected.<BR>Added 
      GetEditWnd to CGridCellBase<BR>Fixed the paste bug for cells being edited 
      (Gary Lyben).<BR>GVN_SELCHANGING/GVN_SELCHANGED messages now sent 
      correctly<BR>OnRButtonUp was not handling clicks on fixed cells 
      correctly<BR>SB_ENDSCROLL message now sent on keypress initiated 
      scroll<BR>GetCellTextExtent bug fixed (Elco)<BR>SetSelectedRange 
      inefficiency fixed by huangchaoyi (ahaa007@263.net)<BR>DT_NOCLIP removed 
      from CGridCellBase::Paint<BR>SetRowCount returns correct value on OOM 
      condition (asigal@hotmail.com)<BR>Bug when editing using Japanese 
      characters fixed (Michael Dunn)<BR>Fixed columns and rows printed 
      correctly (fletch - untested)<BR>Added the "ClearCells" function<BR>Added 
      the "SetCompareFunction" function and revamped sorting<BR>Added 
      "GetEditWnd()" to CGridCellBase<BR>Added "GetTipText" to 
    CGridCellBase<BR></TD></TR></TBODY></TABLE><!-- Article Ends -->
<H2>About Chris Maunder</H2>
<P>Chris is the founder and site administrator for CodeProject.com. He's been 
programming in C/C++ for 10 years and Visual C++/MFC for 4 years. His background 
includes pure and applied mathematics, engineering and physics, and he is 
currently based in Canberra, Australia.</P>
<P>Click <A href="http://www.codeproject.com/" target=_blank>here</A> to visit 
Chris Maunder's homepage.</P>
<FORM action=/script/rating/code/app/insert_vote.asp method=post><INPUT 
name=vote_name type=hidden value=/miscctrl/gridctrl.asp> <INPUT name=goal 
type=hidden value=/miscctrl/gridctrl.asp> 
<TABLE bgColor=#ff9900 border=0 cellPadding=1 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD width="100%">
      <TABLE bgColor=#fbedbb border=0 cellPadding=2 cellSpacing=0 
        width="100%"><TBODY>
        <TR>
          <TD vAlign=center><A 
            href="http://www.codeproject.com/miscctrl/gridctrl.asp#__top"><FONT 
            style="FONT-SIZE: 9pt">[Top]</FONT></A></TD>
          <TD align=right vAlign=center>Rate this Article for 
            us!&nbsp;&nbsp;&nbsp;&nbsp; <I>Poor</I><INPUT name=rate type=radio 
            value=1><INPUT name=rate type=radio value=2><INPUT name=rate 
            type=radio value=3><INPUT name=rate type=radio value=4><INPUT 
            name=rate type=radio value=5><I>Excellent</I>&nbsp;&nbsp; <INPUT class=FormButton type=submit value=Vote></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
<SCRIPT language=JavaScript>
var Selected = "";
var AdTime = new Date();
document.writeln("<iframe name=AdFrame width=0 height=0 frameborder=0></IFRAME>");
</SCRIPT>

<SCRIPT event=onclick for=DynMessLink language=JavaScript>
	var now = new Date();
	if (now - AdTime > 10000)
	{
		AdTime = now;
		var loc = document.frames("AdFrame");
		if (loc) loc = loc.document;
		if (loc) loc = loc.location;
		if (loc) loc.replace('/script/comments/fetchAd.asp');
	}
	//alert("hello");
	var elmref;
	if (Selected != "")
	{
		elmref = eval("document.all('" + Selected + "_h1')");
		if (elmref) elmref.style.display = 'none';
		elmref = eval("document.all('" + Selected + "_h0')");
		if (elmref) elmref.bgColor = '#FEF9E7';
	}
	Selected = this.name;
	
	elmref = eval("document.all('" + this.name + "_h1')");
	if (elmref) 
	{
		if (elmref.style.display=='none') elmref.style.display='';
		else elmref.style.display = 'none';
	}
	elmref = eval("document.all('" + this.name + "_h0')");
	if (elmref) 
	{
		elmref.bgColor = '#99CCFF';
	}
	window.navigate("#xx" + Selected + "xx");
	return false;
</SCRIPT>

<TABLE bgColor=#ff9900 border=0 cellPadding=0 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD width="100%">
      <TABLE bgColor=#ff9900 border=0 cellPadding=0 cellSpacing=1 
        width="100%"><FORM 
        action=/script/comments/app/do_filtermessages.asp?main=/miscctrl/gridctrl.asp 
        method=post>
        <TBODY>
        <TR>
          <TD>
            <TABLE bgColor=white border=0 cellPadding=3 cellSpacing=0 
            width="100%">
              <TBODY>
              <TR bgColor=#fbedbb>
                <TD class=smalltext colSpan=2 vAlign=top 
width="100%">&nbsp;</TD>
                <TD align=right class=smalltext colSpan=2 noWrap 
                  vAlign=top>Keyword Filter <INPUT class=smalltext name=keywords 
                  size=15></TD>
                <TD align=right vAlign=top><INPUT class=FormButton name=submit type=submit value="Set Options"></TD></TR>
              <TR bgColor=#ff9900>
                <TD width="100%">&nbsp;</TD>
                <TD class=smalltext noWrap vAlign=top>View <SELECT 
                  class=smalltext name=expand size=1><OPTION 
                    value=0>Normal</OPTION> <OPTION value=2>Preview</OPTION> 
                    <OPTION selected value=5>Use 
                DHTML</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD class=smalltext noWrap vAlign=top>Per page <SELECT 
                  class=smalltext name=perpage size=1><OPTION 
                    value=10>10</OPTION> <OPTION selected 
                  value=25>25</OPTION></SELECT></TD>
                <TD class=smalltext noWrap vAlign=center>&nbsp;&nbsp;Messages 
                  since </TD>
                <TD class=smalltext vAlign=top><SELECT class=smalltext 
                  name=datefilter size=1><OPTION value=0>23:43 29 May 
                    01</OPTION> <OPTION value=1>Last Day</OPTION> <OPTION 
                    value=2>Last Week</OPTION> <OPTION value=3>Last 
                    Month</OPTION> <OPTION selected value=5>Last 6 
                    Months</OPTION> <OPTION value=6>Last Year</OPTION> <OPTION 
                    value=100>All</OPTION></SELECT></TD></TR></TBODY></TABLE></TD></TR></FORM>
        <TR bgColor=#fbedbb>
          <TD>
            <TABLE bgColor=#fbedbb border=0 width="100%">
              <TBODY>
              <TR>
                <TD><FONT class=messagetitle><A class=HoverLink 
                  href="http://www.codeproject.com/script/comments/user_new.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18" 
                  name=HoverNL target=_top 
                  title="Add a new message to the discussions"><B><IMG align=top 
                  border=0 height=16 src="CGridCtrl_files/admin_modify.gif" 
                  width=16> New thread</B></A></FONT></TD>
                <TD><FONT class=messagetitle>Messages 1 to 25 of 403 (Total: 
                  403)</FONT></TD>
                <TD align=right><FONT class=messagetitle><SPAN 
                  class=HoverLink>First</SPAN> <SPAN class=HoverLink>Prev</SPAN> 
                  <A class=HoverLink 
                  href="http://www.codeproject.com/miscctrl/gridctrl.asp?&amp;fr=26#xx0xx" 
                  name=HoverNL>Next</A> <A class=HoverLink 
                  href="http://www.codeproject.com/miscctrl/gridctrl.asp?&amp;fr=401#xx0xx" 
                  name=HoverNL>Last</A></FONT></TD></TR></TBODY></TABLE></TD></TR>
        <TR bgColor=white>
          <TD>
            <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD bgColor=#fbedbb width="70%">
                  <TABLE border=0 cellPadding=2 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT 
                    class=messagetitle>Subject&nbsp;</FONT></TD></TR></TBODY></TABLE></TD>
                <TD bgColor=#fbedbb width="20%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><IMG border=0 height=1 src="CGridCtrl_files/t.gif" 
                        width=1></TD></TR>
                    <TR>
                      <TD><FONT class=messagetitle>Author&nbsp;</FONT></TD></TR>
                    <TR>
                      <TD><IMG border=0 height=1 src="CGridCtrl_files/t.gif" 
                        width=1></TD></TR></TBODY></TABLE></TD>
                <TD bgColor=#fbedbb width="10%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><IMG border=0 height=1 src="CGridCtrl_files/t.gif" 
                        width=1></TD></TR>
                    <TR>
                      <TD align=right><FONT 
                        class=messagetitle>Date&nbsp;</FONT></TD></TR>
                    <TR>
                      <TD><IMG border=0 height=1 src="CGridCtrl_files/t.gif" 
                        width=1></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=6 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR bgColor=#fef9e7 id=32391_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx32391xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=32391#xx32391xx" 
                        id=DynMessLink name=32391><B>Notify row 
                        selection</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Hasch</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>11:09 29 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=32391_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I would 
                                like to do something (enable/disable a button) 
                                in the dialog using the grid on row selection. 
                                This is the setup of my 
                                grid:<BR>m_ctrlGrid.SetEditable(FALSE);<BR>m_ctrlGrid.SetColumnResize();<BR>m_ctrlGrid.SetListMode();<BR>m_ctrlGrid.SetSingleRowSelection();<BR>m_ctrlGrid.SetHeaderSort(TRUE);<BR><BR>I 
                                read something of a GVN_SELCHANGED but I don't 
                                know how to use it. Has someone a sample code 
                                what to to in my dialog and what to do in the 
                                grid?<BR><BR>Thanks<BR>Hans-Peter 
                                <BR><BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=32391" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=32391" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=32391&amp;forumid=18&amp;select=32391#xx32391xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=32391"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=32391"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=31705_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx31705xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=31705#xx31705xx" 
                        id=DynMessLink name=31705><B>DoModal and CGridCtrl in 
                        extension DLL</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Enrico D.R.</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>16:28 24 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=31705_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hello 
                                everyone<BR>I used CGridCtrl into an MFC 
                                Extension DLL, but for some reason that i don't 
                                know the function starts magically DoModal, 
                                Under Win2000, NT4, 98, 95, Me. This is some of 
                                my code..<BR>(I used CHtmlView for the exe, if i 
                                use Dialog Based Apps all works 
                                fine)<BR><BR>VisualizationFunction()<BR>{CGridCtrlDlg 
                                dlg;<BR>dlg.DoModal(); &lt;-Always executed <IMG 
                                align=absMiddle 
                                src="CGridCtrl_files/smiley_dead.gif"><BR>/* 
                                dlg.DoModal(123); */ } I used my overloaded 
                                function only to verify where was the 
                                problem<BR><BR>I overloaded DoModal to see if 
                                the problem was there<BR><BR>int 
                                CGridCtrlDlg::DoModal(int 
                                test)<BR>{AfxMessageBox ("Executed DoModal, not 
                                good!!",MB_OK | MB_ICONISTOP);<BR>return 
                                CDialog::DoModal();}<BR><BR>Why the h**l start 
                                domodal if no one press keys and nobody sends 
                                messages to my app?<BR>Somonbe could find an 
                                answer? All my DLLs use CDaoRecordset to access 
                                data, and into the classes of the dialogs i 
                                included resource.h: else VC++ was unable to 
                                find resource IDs. <BR>PS I tried to change the 
                                HINSTANCE hInst = AfxGetInstanceHandle(), change 
                                all inline function to standard functions, but 
                                it doesn't work <IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_cry.gif">(<BR><BR>Thanks 
                                in advance (and excuse my english!) Enrico 
                                D.R.<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31705" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31705" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=31705&amp;forumid=18&amp;select=31705#xx31705xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31705"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31705"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=31540_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx31540xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=31540#xx31540xx" 
                        id=DynMessLink name=31540><B>combo box requires lost 
                        focus to accept selection</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Paul Runstedler</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>15:03 23 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=31540_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                all!<BR>Does anyone know how I can setup the 
                                combo box so that after the list is displayed I 
                                only have to click once for the EndEdit to be 
                                called?<BR><BR>I tried overriding the 
                                OnLButtonUp for the CComboBox that is a part of 
                                the GridCellCombo but to no avail. For some 
                                reason the CComboBox did not seem to receive the 
                                click event.<BR><BR>Any hep would be greatly 
                                appreciated,<BR><BR>Paul 
                                Runstedler<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31540" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31540" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=31540&amp;forumid=18&amp;select=31540#xx31540xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31540"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31540"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=31497_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx31497xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=31497#xx31497xx" 
                        id=DynMessLink name=31497><B>Notification for focused 
                        cell changed</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>5:56 23 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=31497_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I need 
                                a notification when the focused cell has 
                                changed. First I try it with selection changed 
                                notification, but it is not send, when browsing 
                                with the arrow keys throw the grid. So I made 
                                the following additions:<BR><BR>in 
                                GridCtrl.h:<BR>#define GVN_FOCUSCHANGED 
                                LVN_ITEMACTIVATE<BR><BR>in 
                                GridCtrl.cpp:<BR>CCellID 
                                CGridCtrl::SetFocusCell(CCellID cell)<BR>{<BR>if 
                                (cell == m_idCurrentCell)<BR>return 
                                m_idCurrentCell;<BR><BR>CCellID idPrev = 
                                m_idCurrentCell;<BR><BR>// EFW - Bug Fix - Force 
                                focus to be in a non-fixed cell<BR>if(cell.row 
                                != -1 &amp;&amp; cell.row &lt; 
                                GetFixedRowCount())<BR>cell.row = 
                                GetFixedRowCount();<BR>if(cell.col != -1 
                                &amp;&amp; cell.col &lt; 
                                GetFixedColumnCount())<BR>cell.col = 
                                GetFixedColumnCount();<BR><BR>m_idCurrentCell = 
                                cell;<BR><BR>if 
                                (IsValid(idPrev))<BR>{<BR>SetItemState(idPrev.row, 
                                idPrev.col,<BR>GetItemState(idPrev.row, 
                                idPrev.col) &amp; 
                                ~GVIS_FOCUSED);<BR>RedrawCell(idPrev); // 
                                comment to reduce flicker<BR><BR>if 
                                (GetTrackFocusCell() &amp;&amp; idPrev.col != 
                                m_idCurrentCell.col)<BR>for (int row = 0; row 
                                &lt; m_nFixedRows; row++)<BR>RedrawCell(row, 
                                idPrev.col);<BR>if (GetTrackFocusCell() 
                                &amp;&amp; idPrev.row != 
                                m_idCurrentCell.row)<BR>for (int col = 0; col 
                                &lt; m_nFixedCols; 
                                col++)<BR>RedrawCell(idPrev.row, 
                                col);<BR>}<BR><BR>if 
                                (IsValid(m_idCurrentCell))<BR>{<BR>SetItemState(m_idCurrentCell.row, 
                                m_idCurrentCell.col,<BR>GetItemState(m_idCurrentCell.row, 
                                m_idCurrentCell.col) | 
                                GVIS_FOCUSED);<BR><BR>RedrawCell(m_idCurrentCell); 
                                // comment to reduce flicker<BR><BR>if 
                                (GetTrackFocusCell() &amp;&amp; idPrev.col != 
                                m_idCurrentCell.col)<BR>for (int row = 0; row 
                                &lt; m_nFixedRows; row++)<BR>RedrawCell(row, 
                                m_idCurrentCell.col);<BR>if (GetTrackFocusCell() 
                                &amp;&amp; idPrev.row != 
                                m_idCurrentCell.row)<BR>for (int col = 0; col 
                                &lt; m_nFixedCols; 
                                col++)<BR>RedrawCell(m_idCurrentCell.row, 
                                col);<BR><BR>// EFW - New addition. If in list 
                                mode, make sure the selected<BR>// row highlight 
                                follows the cursor.<BR>// Removed by C Maunder 
                                27 May<BR>//if (m_bListMode)<BR>//{<BR>// 
                                m_PrevSelectedCellMap.RemoveAll();<BR>// 
                                m_MouseMode = MOUSE_SELECT_ROW;<BR>// 
                                OnSelecting(m_idCurrentCell);<BR><BR>// Leave 
                                this off so that you can still drag the 
                                highlight around<BR>// without selecting 
                                rows.<BR>// m_MouseMode = 
                                MOUSE_NOTHING;<BR>//}<BR><BR>// Inserted for 
                                focus changed notification 
                                (23.05.01)<BR>TRACE2("CGridCtrl::SetFocusCell: 
                                focused cell changed, row=%d, 
                                col=%d\n",m_idCurrentCell.row,m_idCurrentCell.col);<BR>SendMessageToParent(m_idCurrentCell.row, 
                                m_idCurrentCell.col, 
                                GVN_FOCUSCHANGED);<BR>}<BR>return 
                                idPrev;<BR>}<BR><BR>PS<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31497" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=31497&amp;forumid=18&amp;select=31497#xx31497xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31497"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31497"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=31354_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx31354xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=31354#xx31354xx" 
                        id=DynMessLink name=31354><B>The same bug in 
                        SetModified</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>9:05 22 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=31354_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>The 
                                SetModified function has the same problem. It 
                                doesn't work with the first (0) row or 
                                column.<BR>The source for fixing that 
                                problem:<BR><BR>void CGridCtrl::SetModified(BOOL 
                                bModified /*=TRUE*/, int nRow /*=-1*/, int nCol 
                                /*=-1*/)<BR>{<BR>// Cannot guarantee sorting 
                                anymore...<BR>if (nCol &lt; 0 || nCol == 
                                GetSortColumn())<BR>SetSortColumn(-1);<BR><BR>// 
                                if (nRow &gt; 0 &amp;&amp; nCol &gt; 0)<BR>if 
                                (nRow &gt;= 0 &amp;&amp; nCol &gt;= 
                                0)<BR>{<BR>if 
                                (bModified)<BR>{<BR>SetItemState(nRow, nCol, 
                                GetItemState(nRow, nCol) | 
                                GVIS_MODIFIED);<BR>m_bModified = 
                                TRUE;<BR>}<BR>else<BR>SetItemState(nRow, nCol, 
                                GetItemState(nRow, nCol) &amp; 
                                ~GVIS_MODIFIED);<BR>}<BR>else<BR>m_bModified = 
                                bModified;<BR><BR>if (!m_bModified)<BR>{<BR>for 
                                (int row = 0; row &lt; GetRowCount(); 
                                row++)<BR>for (int col = 0; col &lt; 
                                GetColumnCount(); col++)<BR>SetItemState(row, 
                                col, GetItemState(row, col) &amp; 
                                ~GVIS_MODIFIED);<BR>}<BR>}<BR><BR>PS<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31354" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=31354&amp;forumid=18&amp;select=31354#xx31354xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31354"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31354"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=31351_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx31351xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=31351#xx31351xx" 
                        id=DynMessLink name=31351><B>Bug in 
                        GetModified</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>8:52 22 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=31351_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I found 
                                a problem in GetModified. It doesn't work with 
                                the first (0) row or column.<BR>Here is the 
                                source for fixing that problem:<BR><BR>BOOL 
                                CGridCtrl::GetModified(int nRow /*=-1*/, int 
                                nCol /*=-1*/)<BR>{<BR>// if (nRow &gt; 0 
                                &amp;&amp; nCol &gt; 0)<BR>if (nRow &gt;= 0 
                                &amp;&amp; nCol &gt;= 0)<BR>return ( 
                                (GetItemState(nRow, nCol) &amp; GVIS_MODIFIED) 
                                == GVIS_MODIFIED );<BR>else<BR>return 
                                m_bModified;<BR>}<BR><BR><BR><BR>PS<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31351" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=31351&amp;forumid=18&amp;select=31351#xx31351xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31351"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31351"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=31340_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx31340xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=31340#xx31340xx" 
                        id=DynMessLink 
                      name=31340><B>Scrollbars!</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Paul Runstedler</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>8:18 22 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=31340_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Does 
                                anyone know how to force the grid control to 
                                always show a vertical scrollbar? I went through 
                                the code and everwhere that a SetScrollInfo 
                                appeared, I orderd the fMask portion of 
                                SCROLLINFO with SIF_DISABLENOSCROLL. According 
                                to the help this should disable the scrollbarsw 
                                when they are not needed instead of removing 
                                them. It didn't work. The scroll bars are still 
                                not there at all!<BR><BR>Help!<BR><BR>Paul 
                                Runstedler<BR><IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_cry.gif"><BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31340" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31340" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=31340&amp;forumid=18&amp;select=31340#xx31340xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31340"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31340"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=6 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR bgColor=#fef9e7 id=31539_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx31539xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=18><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=31539#xx31539xx" 
                        id=DynMessLink name=31539>Re: Scrollbars!</A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070>Paul Runstedler&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070>15:00 23 May 01&nbsp;</FONT></TD></TR>
              <TR id=31539_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=18><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I have 
                                found a fix for this. I had to modify a bit of 
                                code but here it is if anyone is 
                                interested.<BR><BR>I learned that you have to 
                                use a special flag in the SetScrollInfo() method 
                                to get a scrollbar that stays around after it is 
                                not needed. I made the following modifications 
                                to GridCtrl.cpp in the end of the 
                                ResetScrollBars method<BR><BR>SCROLLINFO 
                                si;<BR>si.cbSize = 
                                sizeof(SCROLLINFO);<BR>si.fMask = SIF_PAGE | 
                                SIF_RANGE;<BR>si.nPage = (m_nHScrollMax&gt;0)? 
                                VisibleRect.Width() : 0;<BR>si.nMin = 
                                0;<BR>si.nMax = m_nHScrollMax;<BR>// 
                                SetScrollInfo(SB_HORZ, &amp;si, FALSE); 
                                PAUL<BR>SetScrollInfo(SB_HORZ, &amp;si, 
                                TRUE);<BR>si.fMask |= 
                                SIF_DISABLENOSCROLL;<BR>si.nPage = 
                                (m_nVScrollMax&gt;0)? VisibleRect.Height() : 
                                0;<BR>si.nMin = 0;<BR>si.nMax = 
                                m_nVScrollMax;<BR>// SetScrollInfo(SB_VERT, 
                                &amp;si, FALSE);<BR>SetScrollInfo(SB_VERT, 
                                &amp;si, TRUE);<BR><BR>//PAUL Commented these 
                                out.<BR>// SetScrollRange(SB_VERT, 0, 
                                m_nVScrollMax, TRUE);<BR>// 
                                SetScrollRange(SB_HORZ, 0, m_nHScrollMax, 
                                TRUE);<BR><BR>//TRACE(_T("H scroll: %d, V Scroll 
                                %d\n"), m_nHScrollMax, 
                                m_nVScrollMax);<BR>}<BR><BR>SetScrollRange(), 
                                when called after the SetScrollInfo() conflicts 
                                with the flag that would normally keep the 
                                scrollbar up when its not needed. I needed to 
                                remove these calls. I found out they are not 
                                needed (for WinCE3.0 anyway) because you can set 
                                the range during your SetScrollInfo() call. I 
                                did this and I also ORed the fMask with 
                                SIF_DISABLENOSCROLL. This only works when 
                                setting the Range, so I had to OR the fMask with 
                                SIF_RANGE. I should note that I only set the 
                                SIF_DISABLENOSCROLL for the vertical scroll bar 
                                since I don't want the horizontal around when 
                                its not needed <IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_smile.gif"><BR><BR>I 
                                also needed to perform a SetScrollInfo() in my 
                                own code that used the grid control (with min 
                                set to 0 and max set to 1). I needed to do this 
                                because if Min and Max are set to 0, the 
                                SIF_DISABLENOSCROLL is ignored. Here's the code 
                                I used for this:<BR>SCROLLINFO si;<BR>si.cbSize 
                                = sizeof(SCROLLINFO);<BR>si.fMask = SIF_RANGE | 
                                SIF_DISABLENOSCROLL;<BR>si.nMin = 0;<BR>si.nMax 
                                = 100;<BR>m_ItemList.SetScrollInfo( SB_VERT, 
                                &amp;si, FALSE);<BR>si.nMin = 0;<BR>si.nMax = 
                                0;<BR>m_ItemList.SetScrollInfo( SB_VERT, 
                                &amp;si, TRUE);<BR><BR>Come to think of it, I 
                                might have overkilled this one a bit, oh well 
                                <IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_wink.gif"><BR><BR>Anyway, 
                                I did find a bug (or what I consider one anyway) 
                                with how the grid control brings up the 
                                horizontal scrollbar.<BR>In GridCtrl.cpp in the 
                                ResetScrollBars method I had to muck with the 
                                code that determines if a horizontal scrollbar 
                                should appear. Basically, a horizontal scrollbar 
                                was appearing when it wasn't necessary. I 
                                discovered that it acted differently on the 
                                Emulator for WinCe3.0 than on the device (big 
                                surprise there <IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_wink.gif"><BR>Anyway, 
                                Here is my fix so that a horizontal scrollbar 
                                does not appear unnecessarily<BR><BR>#ifdef 
                                _X86_<BR>if ( (VisibleRect.Width()+2) &lt; 
                                VirtualRect.Width())<BR>#else<BR>if ( 
                                (VisibleRect.Width()+13) &lt; 
                                VirtualRect.Width())<BR>#endif<BR>{<BR>EnableScrollBars(SB_HORZ, 
                                TRUE); <BR>m_nHScrollMax = VirtualRect.Width() - 
                                1;<BR>}<BR><BR><BR>Anyway, hope this is helpful 
                                for someone.<BR><IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_smile.gif"><BR><BR><BR>Paul 
                                Runstedler<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31539" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31539" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=31340&amp;forumid=18&amp;select=31539#xx31539xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31539"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31539"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=31261_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx31261xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=31261#xx31261xx" 
                        id=DynMessLink name=31261><B>Text 
                        Alignment</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>19:12 21 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=31261_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>.<IMG 
                                align=absMiddle 
                                src="CGridCtrl_files/smiley_confused.gif"> 
                                <BR>Hi,<BR>How do I align the text in a 
                                cell?<BR>I would like to make all the cells 
                                default to center alignment, can this be done? 
                                Does someone have an example? I tried the 
                                SetItemFormat, but I get an error for anything I 
                                try.<BR><BR>Thanks for any 
                                help<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31261" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=31261&amp;forumid=18&amp;select=31261#xx31261xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31261"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31261"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=31038_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx31038xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=31038#xx31038xx" 
                        id=DynMessLink name=31038><B>Link 
                      errors</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Particle</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>16:49 20 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=31038_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>I can't compile 
                                anything using the grid control with Embedded 
                                Visual c++ 3.<BR><BR>BOOL 
                                CCruisemateGrid::OnInitDialog() 
                                <BR>{<BR>CDialog::OnInitDialog();<BR><BR>CRect 
                                rect; <BR>GetClientRect(rect);<BR>rect.top += 
                                20;<BR>CGridCtrl grid;<BR>grid.Create(rect, 
                                this, IDC_GRIDHEADER1);<BR><BR>Will always give 
                                me this error, not matter which Platform I 
                                choose(sh3,mips,etc)<BR><BR>Linking...<BR>mytestGrid.obj 
                                : error LNK2019: unresolved external symbol 
                                "public: virtual __thiscall 
                                CGridCtrl::~CGridCtrl(void)" 
                                (??1CGridCtrl@@UAE@XZ) referenced in function 
                                "protected: virtual int __thiscall 
                                CmytestGrid::OnInitDialog(void)" 
                                (?OnInitDia<BR>log@CmytestGrid@@MAEHXZ)<BR>mytestGrid.obj 
                                : error LNK2019: unresolved external symbol 
                                "public: int __thiscall CGridCtrl::Create(struct 
                                tagRECT const &amp;,class CWnd *,unsigned 
                                int,unsigned long)" 
                                (?Create@CGridCtrl@@QAEHABUtagRECT@@PAVCWnd@@IK@Z) 
                                referenced in function "prot<BR>ected: virtual 
                                int __thiscall CmytestGrid::OnInitDialog(void)" 
                                (?OnInitDialog@CmytestGrid@@MAEHXZ)<BR>mytestGrid.obj 
                                : error LNK2019: unresolved external symbol 
                                "public: __thiscall 
                                CGridCtrl::CGridCtrl(int,int,int,int)" 
                                (??0CGridCtrl@@QAE@HHHH@Z) referenced in 
                                function "protected: virtual int __thiscall 
                                CmytestGrid::OnInitDialog(void)" 
                                (?OnI<BR>nitDialog@CmytestGrid@@MAEHXZ)<BR>X86EMRel/mytest2.exe 
                                : fatal error LNK1120: 3 unresolved 
                                externals<BR>Error executing 
                                link.exe.<BR><BR>Any help would be 
                                appreciated.<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31038" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31038" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=31038&amp;forumid=18&amp;select=31038#xx31038xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31038"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=31038"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=30826_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx30826xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=30826#xx30826xx" 
                        id=DynMessLink name=30826><B>insertColumn 
                        bug.</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Paul Runstedler</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>11:31 18 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=30826_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I just 
                                upgraded from 2.20 to 2.22 and I have the 
                                following problem. The columns that I used to 
                                have formatted so that text was right aligned, 
                                are now left aligned. In fact, everything is 
                                left aligned now! Does anyone know why this 
                                would have changed with the new version of the 
                                application? I didn't change anything else in my 
                                project! <BR><BR>Basically when I create the 
                                grid I use insertColumn in the following 
                                way:<BR><BR>// Add 
                                columns<BR>m_ItemList.InsertColumn(_T("Product"), 
                                DT_LEFT);<BR>m_ItemList.InsertColumn(_T("Desc."), 
                                DT_LEFT);<BR>m_ItemList.InsertColumn(_T("Qty"), 
                                DT_RIGHT);<BR>m_ItemList.InsertColumn(_T("Amt"), 
                                DT_RIGHT);<BR>m_ItemList.InsertColumn(_T("LineItemPtr"), 
                                DT_RIGHT);<BR>m_ItemList.InsertColumn(_T("LastValid_Product"), 
                                DT_RIGHT);<BR>m_ItemList.InsertColumn(_T("LastValid_Qty"), 
                                DT_RIGHT);<BR>This is the code that inserts the 
                                columns after I've done some other 
                                initialization.<BR><BR>Thanks in 
                                advance.<BR><BR>Paul Runstedler<BR><BR>PS: 
                                Awesome control. It has made things so much 
                                easier on Win CE 3.0!<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30826" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30826" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=30826&amp;forumid=18&amp;select=30826#xx30826xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30826"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30826"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=30387_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx30387xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=30387#xx30387xx" 
                        id=DynMessLink name=30387><B>Scrolling doesn't include 
                        the last row if there is a fixed row</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>8:48 16 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=30387_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>When 
                                the grid is set with a fixed row, say 1, the 
                                last row won't be refreshed when scrolling down 
                                using the scroll bar. Any idea?<BR>This problem 
                                does not happen if there is no fixed 
                                row.<BR><BR>K.F.<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30387" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30387" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=30387&amp;forumid=18&amp;select=30387#xx30387xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30387"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30387"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=30109_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx30109xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=30109#xx30109xx" 
                        id=DynMessLink name=30109><B>Bug? Can't set default 
                        background color for fixed row/col 
                      cells?</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>19:45 14 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=30109_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>First, I'm very 
                                impressed with the grid so far. Congratulations, 
                                and many thanks!<BR><BR>I'm using the grid in a 
                                view (derived from CView) as described elsewhere 
                                on this site.<BR>I've tried setting the 
                                background colours for the various 
                                GetDefaultCell types.<BR>It seems to work for 
                                the non fixed cells, and for cells that are 
                                fixed either as a row or column, but it does not 
                                seem to work for cells that are both fixed row 
                                and column. These cells always seem to get the 
                                same colour as the fixed column.<BR><BR>Here is 
                                some sample code:<BR><BR>void 
                                CGridView::OnInitialUpdate() 
                                <BR>{<BR>CView::OnInitialUpdate();<BR><BR>if 
                                (m_pGC == NULL) // Have we already done this 
                                bit?<BR>{<BR>m_pGC = new CGridCtrl; // Create 
                                the Gridctrl object<BR><BR>CRect rect; // Create 
                                the Gridctrl 
                                window<BR>GetClientRect(rect);<BR>m_pGC-&gt;Create(rect, 
                                this, IDC_GRID);<BR><BR>m_pGC-&gt;ModifyStyle 
                                (WS_BORDER, 0);<BR>m_pGC-&gt;ModifyStyleEx 
                                (WS_EX_CLIENTEDGE, 
                                0);<BR><BR>m_pGC-&gt;SetRowCount (10); // fill 
                                it up with stuff<BR>m_pGC-&gt;SetColumnCount 
                                (10);<BR><BR>m_pGC-&gt;SetFixedRowCount 
                                (2);<BR>m_pGC-&gt;SetFixedColumnCount 
                                (2);<BR><BR>CGridCellBase* pDefaultCell = 
                                m_pGC-&gt;GetDefaultCell (FALSE, 
                                FALSE);<BR>CGridCellBase* pFixedColCell = 
                                m_pGC-&gt;GetDefaultCell (FALSE, 
                                TRUE);<BR>CGridCellBase* pFixedRowCell = 
                                m_pGC-&gt;GetDefaultCell (TRUE, 
                                FALSE);<BR>CGridCellBase* pFixedRowColCell = 
                                m_pGC-&gt;GetDefaultCell (TRUE, 
                                TRUE);<BR><BR>pDefaultCell-&gt;SetBackClr 
                                (RGB(255,0,0)); // 
                                red<BR>pFixedColCell-&gt;SetBackClr 
                                (RGB(0,255,0)); // 
                                green<BR>pFixedRowCell-&gt;SetBackClr 
                                (RGB(0,0,255)); // 
                                blue<BR>pFixedRowColCell-&gt;SetBackClr 
                                (RGB(255,255,0)); // yellow<BR>}<BR>}<BR><BR>Any 
                                ideas?<BR><BR>Also, if I set all the background 
                                colors to white, the grid lines for the fixed 
                                rows/columns are blacker than the grid lines for 
                                the normal cells, is there any way to have the 
                                grid lines the same color?<BR><BR>What I'm 
                                trying to do is to have 2 columns fixed (for 
                                scrolling), but have them look like normal 
                                cells.<BR><BR>Thanks very much,<BR><BR>Sean 
                                McKinnon<BR>mailto:sean@kvs.com<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30109" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=30109&amp;forumid=18&amp;select=30109#xx30109xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30109"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30109"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=6 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR bgColor=#fef9e7 id=30206_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx30206xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=18><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=30206#xx30206xx" 
                        id=DynMessLink name=30206>Re: Bug? Can't set default 
                        background color for fixed row/col cells?</A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070>Anonymous&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070>11:24 15 May 01&nbsp;</FONT></TD></TR>
              <TR id=30206_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=18><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I think 
                                I've found the problem:<BR><BR>In 
                                CGridCtrl::EraseBkgnd(CDC* pDC) at line 644 
                                there is:<BR><BR>// Draw Fixed row/column 
                                background<BR>if (ClipRect.left &lt; 
                                nFixedColumnWidth &amp;&amp; ClipRect.top &lt; 
                                nFixedRowHeight)<BR>pDC-&gt;FillRect(CRect(ClipRect.left, 
                                ClipRect.top, <BR>nFixedColumnWidth, 
                                VisRect.bottom),<BR>&amp;FixedRowColBack);<BR><BR>// 
                                Draw Fixed columns background<BR>if 
                                (ClipRect.left &lt; nFixedColumnWidth &amp;&amp; 
                                ClipRect.top &lt; 
                                VisRect.bottom)<BR>pDC-&gt;FillRect(CRect(ClipRect.left, 
                                ClipRect.top, <BR>nFixedColumnWidth, 
                                VisRect.bottom),<BR>&amp;FixedColBack);<BR><BR>but 
                                I think it should be:<BR><BR>// Draw Fixed 
                                row/column background<BR>if (ClipRect.left &lt; 
                                nFixedColumnWidth &amp;&amp; ClipRect.top &lt; 
                                nFixedRowHeight)<BR>pDC-&gt;FillRect(CRect(ClipRect.left, 
                                ClipRect.top, <BR>nFixedColumnWidth, 
                                nFixedRowHeight), 
                                //VisRect.bottom),<BR>&amp;FixedRowColBack);<BR><BR>// 
                                Draw Fixed columns background<BR>if 
                                (ClipRect.left &lt; nFixedColumnWidth &amp;&amp; 
                                ClipRect.top &lt; 
                                VisRect.bottom)<BR>pDC-&gt;FillRect(CRect(ClipRect.left, 
                                nFixedRowHeight, //ClipRect.top, 
                                <BR>nFixedColumnWidth, 
                                VisRect.bottom),<BR>&amp;FixedColBack);<BR><BR>replacing 
                                VisRect.bottom with nFixedRowHeight in the first 
                                if statement, and replacing ClipRect.top with 
                                nFixedRowHeight in the second if 
                                statement.<BR><BR>The first problem was that the 
                                fixed row/col background was being drawn with a 
                                bottom that extended into the fixed column area, 
                                and the second problem was that the fixed column 
                                background was being drawn with a top that 
                                extended into the fixed row/col 
                                area.<BR><BR>Anybody want to verify that this is 
                                correct, and that I haven't broken anything with 
                                my "fixes".<BR><BR>Thanks -<BR><BR>Sean 
                                McKinnon<BR>mailto:sean@kvs.com<BR><BR>P.S. I've 
                                also figured out why the gridlines in fixed 
                                areas are darker, but I don't see any easy way 
                                around this for me (and besides, it's not a bug, 
                                it's just default behaviour that I wish I could 
                                change).<BR><BR><BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30206" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=30109&amp;forumid=18&amp;select=30206#xx30206xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30206"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=30206"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=29991_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx29991xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=29991#xx29991xx" 
                        id=DynMessLink name=29991><B>Problem with SetImage in 
                        Release Build!</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>7:47 14 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=29991_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>When I 
                                call the member "SetImage" (no text only a 
                                image) of the CGridCtrl I always get an Access 
                                Violation 0XC0000005 if it is a relase build 
                                (using VC++ 5 SP 3)!<BR>When my application is a 
                                debug build, everthing works fine.<BR><BR>Has 
                                anyone noticed the same bug (if it is one) or an 
                                idea for a workaround, please let me know! 
                                Thanks! <BR><BR>Anyway the CGridCtrl is a really 
                                great 
                                control!<BR><BR><BR><BR>Ralph<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29991" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=29991&amp;forumid=18&amp;select=29991#xx29991xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29991"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29991"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=29575_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx29575xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=29575#xx29575xx" 
                        id=DynMessLink name=29575><B>Grid scrollbar hangs up 
                        with large fonts</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>21:22 10 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=29575_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I 
                                turned off "optimize for speed" in MS VC++ and 
                                this bug goes away in the latest version 2.20 of 
                                the grid control!?!<BR><BR>1. Turn on Large 
                                Fonts in the Display Control panel<BR>2. Place a 
                                grid control on a dialog in a window that's too 
                                small for the number of cells (this is probably 
                                where the large fonts come in to play)<BR>3. 
                                Open the dialog and click on the cell on the far 
                                right that's partially off the screen.<BR>4. The 
                                grid control behaves normally and scrolls over 
                                so you can type in a value.<BR>5. Close the 
                                dialog<BR>6. Reopen the dialog<BR>7. Repeat the 
                                exercise, note the scroll bar disappears. You 
                                can also create this efffect by resizing the 
                                columns so they are too big for the 
                                window.<BR>8. Finally, clicking on the cell on 
                                the far right "locks up the computer"<BR>9. 
                                Clicking on Break in the debugger finds us deep 
                                in the MFC code. Looking at the call stack, I 
                                can see the cell click event has gotten very 
                                confused since the mouse position is weird when 
                                the cell is partially off the window and the 
                                scroll bar has disappered.<BR><BR>So obviously 
                                user's shouldn't use "Large Fonts" mode. <IMG 
                                align=absMiddle 
                                src="CGridCtrl_files/smiley_smile.gif"><BR>Changing 
                                the optimization to "default" also seems to fix 
                                the problem. Must be that latest service pack 
                                for VC6...<BR><BR>Just thought you should know. 
                                Thanks &amp; keep up the good work! Onward &amp; 
                                upward to C# v1.0 <IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_smile.gif"><BR><BR><BR>Darrell<BR>dreich@yaNOSPAMhoo.com<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29575" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=29575&amp;forumid=18&amp;select=29575#xx29575xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29575"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29575"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=29465_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx29465xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=29465#xx29465xx" 
                        id=DynMessLink name=29465><B>Ho to use virtual 
                        mode</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>6:44 10 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=29465_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Chris,<BR><BR>Can you please provide a simply 
                                example how to use virtual 
                                mode?<BR><BR>Thanks<BR><BR>Boyi<IMG 
                                align=absMiddle 
                                src="CGridCtrl_files/smiley_confused.gif"><BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29465" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=29465&amp;forumid=18&amp;select=29465#xx29465xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29465"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29465"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=29308_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx29308xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=29308#xx29308xx" 
                        id=DynMessLink name=29308><B>Handling CBN_SELCHANGE 
                        Event</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>12:32 9 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=29308_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>How 
                                should i handle the CBN_SELCHANGE of a combo box 
                                of a specific cell in the combo?<BR>I mean only 
                                one combo in the grid should behave as i want 
                                and no the others combo.<IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_smile.gif"><BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29308" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=29308&amp;forumid=18&amp;select=29308#xx29308xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29308"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=29308"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=28620_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx28620xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_unselected.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=28620#xx28620xx" 
                        id=DynMessLink name=28620><B>Use in non MFC 
                        environment.</B></A></FONT></TD>
                      <TD><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=12067"><IMG 
                        border=0 height=13 src="CGridCtrl_files/userinfo.gif" 
                        title="Confirmed post - See User Info" 
                      width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle><B>Chris 
                  Pichon</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT 
                  class=messagetitle><B>16:52 5 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=28620_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>Your grid control 
                                looks great, there's been a hell of a job behind 
                                it congratulations.<BR>I'm not familiar with MFC 
                                programming, and I would like to include your 
                                Grid Control in my application. Could suggest a 
                                way of using it in a non MFC environmenent (for 
                                PocketPC)<BR>Thanks in 
                                advance.<BR>Chris<BR><BR>Chris 
                                Pichon<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28620" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28620" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=28620&amp;forumid=18&amp;select=28620#xx28620xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28620"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28620"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=6 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR bgColor=#fef9e7 id=28699_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx28699xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=18><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_unselected.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=28699#xx28699xx" 
                        id=DynMessLink name=28699>Re: Use in non MFC 
                        environment.</A></FONT></TD>
                      <TD><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=43"><IMG 
                        border=0 height=13 src="CGridCtrl_files/userinfo.gif" 
                        title="Confirmed post - See User Info" 
                      width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle>Chris 
                  Maunder&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT 
                  class=messagetitle>20:40 6 May 01&nbsp;</FONT></TD></TR>
              <TR id=28699_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=18><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>You can 
                                use it on a PocketPC with the MFC libraries 
                                (just link statically if you don't want to have 
                                the MFC libs on the PPC)<BR><BR>cheers,<BR>Chris 
                                Maunder<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28699" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28699" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=28620&amp;forumid=18&amp;select=28699#xx28699xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28699"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28699"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=28079_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx28079xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_unselected.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=28079#xx28079xx" 
                        id=DynMessLink 
                      name=28079><B>BeginEdit()?</B></A></FONT></TD>
                      <TD><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=12099"><IMG 
                        border=0 height=13 src="CGridCtrl_files/userinfo.gif" 
                        title="Confirmed post - See User Info" 
                      width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle><B>Andrew 
                  Phillips</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT 
                  class=messagetitle><B>23:49 2 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=28079_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent><BR>I 
                                looked but I can't work it out anywhere. How do 
                                I programmatically start a cell edit? I could 
                                send a message that simulates a mouse click on a 
                                cell, but I suspect there is an easier 
                                way.<BR><BR>Also I really like this control but 
                                find it bizarre that you can't insert a row at 
                                the end. You have to use a row number of -1. 
                                This really goes against the C/C++ philosophy of 
                                asymetric bounds (eg. you can have a pointer one 
                                past the end of an array).<BR><BR>This leads to 
                                messy code like:<BR><BR>if (row == 
                                grid_.GetRowCount()-1)<BR>grid.InsertRow("", 
                                -1); // "insert" at 
                                end<BR>else<BR>grid.InsertRow("", 
                                row+1);<BR><BR><BR>instead of the 
                                simpler:<BR>grid.InsertRow("", 
                                row+1);<BR><BR><BR>Andrew Phillips<BR>andrew @ 
                                expertcomsoft.com<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28079" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28079" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=28079&amp;forumid=18&amp;select=28079#xx28079xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28079"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=28079"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=27729_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx27729xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=27729#xx27729xx" 
                        id=DynMessLink name=27729><B>Find</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Manish K Agarwal</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>1:48 1 May 01</B>&nbsp;</FONT></TD></TR>
              <TR id=27729_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Is any 
                                way to find text in Grid??? <IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_line.gif"><BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27729" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27729" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=27729&amp;forumid=18&amp;select=27729#xx27729xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27729"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27729"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=27447_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx27447xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=27447#xx27447xx" 
                        id=DynMessLink name=27447><B>Bug in 
                        CGridCtrl::ExpandColumnsToFit(BOOL bExpandFixed 
                        /*=TRUE*/)</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Magnus Zakrisson</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>11:13 27 Apr 01</B>&nbsp;</FONT></TD></TR>
              <TR id=27447_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi<BR><BR>There is a bug in 
                                <BR>void CGridCtrl::ExpandColumnsToFit(BOOL 
                                bExpandFixed /*=TRUE*/)<BR><BR>If bExpandFixed 
                                == FALSE and we only have fixed columns then we 
                                will have a division by zero when calculating 
                                nColumnAdjustment.<BR><BR>Regards 
                                Magnus<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27447" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27447" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=27447&amp;forumid=18&amp;select=27447#xx27447xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27447"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27447"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=27117_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx27117xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=27117#xx27117xx" 
                        id=DynMessLink name=27117><B>3d look in a 
                        cell</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Anonymous</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>17:16 24 Apr 01</B>&nbsp;</FONT></TD></TR>
              <TR id=27117_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>This is 
                                a great grid. <IMG align=absMiddle 
                                src="CGridCtrl_files/smiley_wink.gif"> I've used 
                                other grids and this one is lean and fast. I 
                                would like to know if there is a way to make a 
                                cell have a 3d raised look like the top row and 
                                the left column. I want to make my right most 
                                column have the look of the left most 
                                column.<BR><BR>Thanks,<BR><BR>Gabriel<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27117" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=27117&amp;forumid=18&amp;select=27117#xx27117xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27117"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27117"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900 colSpan=3 height=1></TD></TR>
              <TR bgColor=#fef9e7 id=27027_h0>
                <TD width="70%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx27027xx></A><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                      src="CGridCtrl_files/news_suss.gif">&nbsp;</TD>
                      <TD width="100%"><FONT class=messagetitle 
                        color=#707070><A 
                        href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;select=27027#xx27027xx" 
                        id=DynMessLink name=27027><B>Printing</B></A></FONT></TD>
                      <TD><IMG alt="Unconfirmed/Anonymous posting" height=13 
                        src="CGridCtrl_files/usersuss.gif" 
                    width=15></A>&nbsp;</TD></TR></TBODY></TABLE></TD>
                <TD noWrap width="20%"><FONT class=messagetitle 
                  color=#707070><B>Peggy</B>&nbsp;</FONT></TD>
                <TD align=right noWrap width="10%"><FONT class=messagetitle 
                  color=#707070><B>10:11 24 Apr 01</B>&nbsp;</FONT></TD></TR>
              <TR id=27027_h1 style="DISPLAY: none">
                <TD colSpan=3 width="100%">
                  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
                    <TBODY>
                    <TR>
                      <TD><FONT class=messagetitle color=#707070><IMG height=1 
                        src="CGridCtrl_files/ind.gif" width=0><IMG 
                        align=absMiddle 
                        src="CGridCtrl_files/news_none.gif">&nbsp;</FONT></TD>
                      <TD bgColor=#d5eaff width="100%">
                        <TABLE border=0 cellPadding=0 cellSpacing=5 
width="100%">
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE border=0 cellPadding=0 cellSpacing=0 
                              width="100%">
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>This is a very 
                                nice control and I have been using it for a 
                                while now.<BR>I was wondering if there is a 
                                possibility to indicate a MinFontSize and 
                                MaxFontSize when printing.<BR>Now it gets sized 
                                automatically to the paper-size, stretching or 
                                minimizing the font to fit the 
                                page.<BR><BR>Thank you very much in 
                                advance,<BR>Peggy.VanLierde@AISystems.be<BR>&nbsp;</FONT></TD></TR>
                                <TR>
                                <TD><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27027" 
                                title="Reply to this current thread">Reply</A>][<A 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27027" 
                                title="Email a reply to the author of this message">Email 
                                author</A>][<A 
                                href="http://www.codeproject.com/miscctrl/gridctrl.asp?tid=27027&amp;forumid=18&amp;select=27027#xx27027xx" 
                                title="View only messages within this thread">View 
                                Thread</A>]</FONT></TD>
                                <TD align=right><FONT class=messagetitle>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27027"><FONT 
                                class=messagetitle><I>Modify</I></A>][<A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/miscctrl/gridctrl.asp&amp;forumid=18&amp;select=27027"><FONT 
                                class=messagetitle><I>Delete</I></A>]</FONT></FONT></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD colSpan=3><IMG border=0 height=5 
                  src="CGridCtrl_files/t.gif" width=1></TD></TR></TBODY></TABLE></TD></TR>
        <TR bgColor=#fbedbb>
          <TD>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD><FONT class=messagetitle>Last Visit: 23:43 Tuesday 29th 
                  May, 2001</FONT></TD>
                <TD align=right><FONT class=messagetitle><SPAN 
                  class=HoverLink>First</SPAN> <SPAN class=HoverLink>Prev</SPAN> 
                  <A class=HoverLink 
                  href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;fr=26#xx0xx" 
                  name=HoverNL>Next</A> <A class=HoverLink 
                  href="http://www.codeproject.com/miscctrl/gridctrl.asp?forumid=18&amp;fr=401#xx0xx" 
                  name=HoverNL>Last</A></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><!-- Footer -->
<TABLE bgColor=#ff9900 border=0 cellPadding=0 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD width="100%">
      <TABLE bgColor=#ff9900 border=0 cellPadding=0 cellSpacing=1 
        width="100%"><TBODY>
        <TR>
          <TD bgColor=#fbedbb colSpan=2>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD><FONT size=1 style="FONT-SIZE: 7pt"><A 
                  href="http://www.codeproject.com/">Home</A> &gt;&gt; <A 
                  href="http://www.codeproject.com/miscctrl/">Miscellaneous 
                  Controls</A> &gt;&gt; <A 
                  href="http://www.codeproject.com/miscctrl/index.asp#Grid Control">Grid 
                  Control</A> <BR>last updated 1 Jan 2001 </FONT></TD>
                <TD align=right><FONT size=1 style="FONT-SIZE: 7pt">Article 
                  content copyright Chris Maunder, 1999<BR>everything else © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2001. </FONT></TD></TR></TBODY></TABLE></TD></TR><!-- Logo and advertisement -->
        <TR>
          <TD><A href="http://www.codeproject.com/"><IMG 
            alt="The Code Project" border=0 height=60 
            src="CGridCtrl_files/cplogo.gif" width=120></A> </TD>
          <TD align=right><SPAN id=AdBanner7><A 
            href="http://www.codeproject.com/script/admentor/ads.asp"><IMG 
            alt="View all our sponsors" border=1 height=60 
            src="CGridCtrl_files/sponsors.gif" width=20></A><A 
            href="http://www.codeproject.com/script/admentor/admentorredir.asp?id=99&amp;way=ban" 
            target=_blank><IMG 
            alt="Click here for the free Dundas Upload control" border=1 
            height=60 src="CGridCtrl_files/uploadbanner.gif" width=468></A><A 
            href="http://www.codeproject.com/info/advertise.asp"><IMG 
            alt="Advertise on the CodeProject" border=1 height=60 
            src="CGridCtrl_files/advertise.gif" width=20></A></SPAN> 
        </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></LI></BODY></HTML>
